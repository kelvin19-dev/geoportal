(self.webpackChunkgeonode_mapstore_client=self.webpackChunkgeonode_mapstore_client||[]).push([[38973],{1550:(e,t,r)=>{"use strict";r.d(t,{pP:()=>o,TR:()=>n,N7:()=>i,mq:()=>a,uv:()=>l,Qy:()=>s,IL:()=>u,Li:()=>c,OW:()=>p,ZO:()=>f,Um:()=>d,TF:()=>y,Ls:()=>m,Ec:()=>b,Eu:()=>g,JJ:()=>v,nZ:()=>h,YD:()=>O,GI:()=>w,Jb:()=>F,Uh:()=>P,e$:()=>E,eh:()=>S,$j:()=>j,bJ:()=>x,Mk:()=>C,xy:()=>T,o6:()=>N,FP:()=>q,Mo:()=>D,sO:()=>_,Px:()=>I,hd:()=>L,Ju:()=>M,BV:()=>A,SO:()=>k,H0:()=>R,$X:()=>B,ou:()=>Z,NE:()=>G,Lq:()=>V,aN:()=>U});var o="CHANGE_MAP_VIEW",n="CLICK_ON_MAP",i="CHANGE_MOUSE_POINTER",a="CHANGE_ZOOM_LVL",l="PAN_TO",s="ZOOM_TO_EXTENT",u="ZOOM_TO_POINT",c="CHANGE_MAP_CRS",p="CHANGE_MAP_SCALES",f="CHANGE_MAP_STYLE",d="CHANGE_ROTATION",y="CREATION_ERROR_LAYER",m="UPDATE_VERSION",b="INIT_MAP",g="RESIZE_MAP",v="CHANGE_MAP_LIMITS",h="SET_MAP_RESOLUTIONS",O="REGISTER_EVENT_LISTENER",w="UNREGISTER_EVENT_LISTENER",F="MOUSE_MOVE",P="MOUSE_OUT",E="MAP:MAP_PLUGIN_LOAD",S="MAP:ORIENTATION",j="MAP:UPDATE_MAP_VIEW",x="MAP:UPDATE_MAP_OPTIONS";function C(e,t,r,o){return{type:E,mapType:t,loading:e,loaded:r,error:o}}function T(e,t,r){return{type:u,pos:e,zoom:t,crs:r}}function N(e,t,r,n,i,a,l,s){return{type:o,center:e,zoom:t,bbox:r,size:n,mapStateSource:i,projection:a,viewerOptions:l,resolution:s}}function q(e,t){return{type:n,point:e,layer:t}}function D(e){return{type:i,pointer:e}}function _(e,t){return{type:a,zoom:e,mapStateSource:t}}function I(e,t,r,o){return{type:s,extent:e,crs:t,maxZoom:r,options:o}}function L(e,t){return{type:f,style:e,mapStateSource:t}}function M(){return{type:g}}function A(e){var t=e.restrictedExtent,r=e.crs,o=e.minZoom;return{type:v,restrictedExtent:t,crs:r,minZoom:o}}function k(e){return{type:h,resolutions:e}}var R=function(e,t){return{type:O,eventName:e,toolName:t}},B=function(e,t){return{type:w,eventName:e,toolName:t}},Z=function(e){return{type:F,position:e}},G=function(){return{type:P}},V=function(e){return{type:S,orientation:e}},U=function(e){return{type:x,configUpdate:e}}},38167:(e,t,r)=>{"use strict";r.d(t,{k9:()=>F,v0:()=>w,ZP:()=>E});var o=r(75263),n=r.n(o),i=r(24852),a=r.n(i),l=r(68195);function s(e){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s(e)}function u(){return u=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},u.apply(this,arguments)}function c(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,b(o.key),o)}}function p(e,t,r){return t=d(t),function(e,t){if(t&&("object"===s(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,f()?Reflect.construct(t,r||[],d(e).constructor):t.apply(e,r))}function f(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(f=function(){return!!e})()}function d(e){return d=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},d(e)}function y(e,t){return y=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},y(e,t)}function m(e,t,r){return(t=b(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function b(e){var t=function(e,t){if("object"!=s(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,"string");if("object"!=s(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==s(t)?t:t+""}var g=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),p(this,t,arguments)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&y(e,t)}(t,e),r=t,(o=[{key:"render",value:function(){return this.context.intl?a().createElement(l.FormattedDate,u({value:this.props.value},this.props.dateParams)):a().createElement("span",null,this.props.value&&this.props.value.toString()||"")}}])&&c(r.prototype,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,o}(a().Component);m(g,"propTypes",{value:n().object,dateParams:n().object}),m(g,"contextTypes",{intl:n().object}),m(g,"defaultProps",{value:new Date});const v=g;var h=r(15402),O=r(5346),w=O.Z,F=h.Z,P=v;const E={Message:O.Z,HTML:F,DateFormat:P}},65539:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s});var o=r(24852),n=r.n(o);function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function l(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?a(Object(r),!0).forEach((function(t){var o,n,a,l;o=e,n=t,a=r[t],l=function(e,t){if("object"!=i(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,"string");if("object"!=i(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(n),(n="symbol"==i(l)?l:l+"")in o?Object.defineProperty(o,n,{value:a,enumerable:!0,configurable:!0,writable:!0}):o[n]=a})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}const s=function(e){var t=e.id,r=e.children,o=e.header,i=e.footer,a=e.columns,s=e.height,u=e.style,c=void 0===u?{}:u,p=e.className,f=e.bodyClassName,d=void 0===f?"ms2-border-layout-body":f;return n().createElement("div",{id:t,className:p,style:l({display:"flex",flexDirection:"column",width:"100%",height:"100%",overflow:"hidden"},c)},o,n().createElement("div",{className:d,style:{display:"flex",flex:1,overflowY:"auto"}},n().createElement("main",{className:"ms2-border-layout-content",style:{flex:1,overflowX:"hidden",position:"relative"}},s?n().createElement("div",{style:{height:s}},r):r),s?n().createElement("div",{style:{height:s}},a):a),i)}},52595:(e,t,r)=>{"use strict";r.d(t,{Z:()=>o});const o=(0,r(61365).Z)(r(80681).Overlay)},94745:(e,t,r)=>{"use strict";r.d(t,{Z:()=>b});var o=r(24852),n=r.n(o),i=r(94184),a=r.n(i),l=r(80681),s=r(7472),u=r(80717),c=r(67076),p=r(19081),f=r.n(p),d=r(75480),y={xs:" ms-xs",sm:" ms-sm",md:"",lg:" ms-lg"},m={className:{vertical:" ms-fullscreen-v",horizontal:" ms-fullscreen-h",full:" ms-fullscreen"},glyph:{expanded:{vertical:"resize-vertical",horizontal:"resize-horizontal",full:"resize-small"},collapsed:{vertical:"resize-vertical",horizontal:"resize-horizontal",full:"resize-full"}}};const b=(0,c.withState)("fullscreenState","onFullscreen",(function(e){var t=e.initialFullscreenState;return void 0===t?"collapsed":t}))((function(e){var t=e.show,r=void 0!==t&&t,o=e.loading,i=e.loadingText,c=e.onClose,p=void 0===c?function(){}:c,b=e.title,g=void 0===b?"":b,v=e.clickOutEnabled,h=void 0===v||v,O=e.showClose,w=void 0===O||O,F=e.disabledClose,P=void 0!==F&&F,E=e.showFullscreen,S=void 0!==E&&E,j=e.fullscreenType,x=void 0===j?"full":j,C=e.buttons,T=void 0===C?[]:C,N=e.size,q=void 0===N?"":N,D=e.bodyClassName,_=void 0===D?"":D,I=e.children,L=e.draggable,M=void 0!==L&&L,A=e.fullscreenState,k=e.onFullscreen,R=e.fade,B=void 0!==R&&R,Z=e.fitContent,G=e.modalClassName,V=void 0===G?"":G,U=e.dialogClassName,z=void 0===U?"":U,W=e.enableFooter,H=void 0===W||W,Q=y[q]||"",$=S&&"expanded"===A&&m.className[x]||"",X=r?n().createElement("div",{className:"modal-fixed ".concat(V," ")+(M?"ms-draggable":"")},n().createElement(s.Z,{id:"ms-resizable-modal",style:{display:"flex"},onClickOut:h?p:function(){},containerClassName:"ms-resizable-modal",draggable:M,modal:!0,className:a()("modal-dialog modal-content",Q,$,z,{"ms-fit-content":Z})},n().createElement("span",{role:"header"},n().createElement("h4",{className:"modal-title"},n().createElement("div",{className:"ms-title"},g),S&&m.className[x]&&n().createElement(l.Glyphicon,{className:"ms-header-btn",onClick:function(){return k("expanded"===A?"collapsed":"expanded")},glyph:m.glyph[A][x]}),w&&p&&n().createElement(l.Glyphicon,{glyph:"1-close",className:"ms-header-btn",onClick:p,disabled:P}))),n().createElement("div",{role:"body",className:_},I),H&&n().createElement("div",{style:{display:"flex"},role:"footer"},n().createElement("div",{className:"ms-resizable-modal-loading-spinner-container"},o?n().createElement(d.Z,null):null),n().createElement("div",{className:"ms-resizable-modal-loading-text"},o?i:null),n().createElement(u.Z,{buttons:T})))):null;return B?n().createElement(f(),{transitionName:"ms-resizable-modal-fade",transitionEnterTimeout:300,transitionLeaveTimeout:300},X):X}))},73849:(e,t,r)=>{"use strict";r.d(t,{Z:()=>p});var o=r(67076),n=r(28878),i=r(49977),a=r.n(i);function l(e){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l(e)}function s(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function u(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?s(Object(r),!0).forEach((function(t){var o,n,i,a;o=e,n=t,i=r[t],a=function(e,t){if("object"!=l(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,"string");if("object"!=l(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(n),(n="symbol"==l(a)?a:a+"")in o?Object.defineProperty(o,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):o[n]=i})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var c=(0,o.mapPropsStreamWithConfig)(n.Z);const p=(0,o.compose)((0,o.defaultProps)({dataStreamFactory:function(){return a().Observable.of({})}}),c((function(e){return e.take(1).switchMap((function(t){return t.dataStreamFactory(e.startWith(t),t)})).combineLatest(e,(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return u(u({},arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}),e)}))})))},2576:(e,t,r)=>{"use strict";r.d(t,{Z:()=>w});var o=r(24852),n=r.n(o),i=r(80307),a=r.n(i),l=r(75263),s=r.n(l),u=r(80681),c=r(52595),p=r(50966);function f(e){return f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},f(e)}function d(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,h(o.key),o)}}function y(e,t,r){return t=b(t),function(e,t){if(t&&("object"===f(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,m()?Reflect.construct(t,r||[],b(e).constructor):t.apply(e,r))}function m(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(m=function(){return!!e})()}function b(e){return b=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},b(e)}function g(e,t){return g=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},g(e,t)}function v(e,t,r){return(t=h(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function h(e){var t=function(e,t){if("object"!=f(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,"string");if("object"!=f(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==f(t)?t:t+""}var O=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),y(this,t,arguments)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&g(e,t)}(t,e),r=t,(o=[{key:"renderPopover",value:function(){return n().createElement(u.Popover,{id:this.props.id,placement:this.props.placement,positionLeft:this.props.left,positionTop:this.props.top,title:this.props.title},this.props.text)}},{key:"renderContent",value:function(){var e=this;return n().createElement(u.Glyphicon,{ref:function(t){e.target=t},className:"text-".concat(this.props.bsStyle),glyph:this.props.glyph})}},{key:"render",value:function(){var e=this,t=!0===this.props.trigger?["hover","focus"]:this.props.trigger;return n().createElement("span",{className:"mapstore-info-popover"},this.props.trigger?n().createElement(p.Z,{trigger:t,placement:this.props.placement,overlay:this.renderPopover()},this.renderContent()):[this.renderContent(),n().createElement(c.Z,{placement:this.props.placement,show:!0,target:function(){return a().findDOMNode(e.target)}},this.renderPopover())])}}])&&d(r.prototype,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,o}(n().Component);v(O,"propTypes",{id:s().string,title:s().string,text:s().string,glyph:s().string,bsStyle:s().string,placement:s().string,left:s().number,top:s().number,trigger:s().oneOfType([s().array,s().bool])}),v(O,"defaultProps",{id:"",title:"",text:"",placement:"right",left:200,top:50,glyph:"question-sign",bsStyle:"info",trigger:["hover","focus"]});const w=O},86850:(e,t,r)=>{"use strict";r.d(t,{V6:()=>L,Mc:()=>A,v$:()=>k,ED:()=>R});var o=r(72500),n=r.n(o),i=r(84596),a=r.n(i),l=r(14293),s=r.n(l),u=r(13218),c=r.n(u),p=r(49977),f=r.n(p),d=r(5055),y=r(7526),m=r(75875),b=r.n(m),g=r(47805),v=r(24262),h=r(10284),O=r(39156),w=["totalFeatures","features"],F=["sortOptions","propertyName"];function P(e){return function(e){if(Array.isArray(e))return E(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return E(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?E(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function E(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,o=new Array(t);r<t;r++)o[r]=e[r];return o}function S(e){return S="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},S(e)}function j(e,t){if(null==e)return{};var r,o,n=function(e,t){if(null==e)return{};var r,o,n={},i=Object.keys(e);for(o=0;o<i.length;o++)r=i[o],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)r=i[o],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function x(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function C(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?x(Object(r),!0).forEach((function(t){var o,n,i,a;o=e,n=t,i=r[t],a=function(e,t){if("object"!=S(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,"string");if("object"!=S(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(n),(n="symbol"==S(a)?a:a+"")in o?Object.defineProperty(o,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):o[n]=i})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):x(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var T=r.n(O)()({wfsVersion:"1.1.0"}),N=T.getFeature,q=T.query,D=T.sortBy,_=T.propertyName,I=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"json",i=(0,g.getWFSFilterData)(t,r),a=n().parse(e,!0),l=c()(a.query)?a.query:{};l.service="WFS",l.outputFormat=o;var s=n().format({protocol:a.protocol,host:a.host,pathname:a.pathname,query:l});return r.layer&&"vector"===r.layer.type?f().Observable.defer((function(){return new Promise((function(e){var o,n=function(e,t){if(t.filterFields&&0!==t.filterFields.length){var r=e.features.filter((0,g.createFeatureFilter)(t));e.features=r,e.numberMatched=r.length,e.numberReturned=r.length,e.totalFeatures=r.length}return t.sortOptions&&t.sortOptions.sortBy&&t.sortOptions.sortOrder&&"NONE"!==t.sortOptions.sortOrder&&e.features.sort((function(e,r){var o=e.properties[t.sortOptions.sortBy],n=r.properties[t.sortOptions.sortBy],i=o.toLowerCase().localeCompare(n.toLowerCase());return"ASC"===t.sortOptions.sortOrder?i:-1*i})),e}({crs:{type:"name",properties:{name:"urn:ogc:def:crs:EPSG::4326"}},numberMatched:(o=r.layer.features).length,numberReturned:o.length,timeStamp:"2020-07-20T11:36:20.118Z",totalFeatures:o.length,type:"FeatureCollection",features:o},t);e(n)}))})):{data:i,queryString:s}},L=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=arguments.length>3?arguments[3]:void 0;if(r.layer&&"vector"===r.layer.type)return I(e,t,r,o);var n=I(e,t,r,o),i=n.data,a=n.queryString;return f().Observable.defer((function(){return b().post(a,i,{timeout:6e4,responseType:"arraybuffer",headers:{Accept:"application/xml","Content-Type":"application/xml"}})}))},M=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(r.layer&&"vector"===r.layer.type)return I(e,t,r);var o=I(e,t,r),n=o.data,i=o.queryString;return f().Observable.defer((function(){return b().post(i,n,{timeout:6e4,headers:{Accept:"application/json","Content-Type":"application/xml"}})})).let(h.oB).map((function(e){return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.totalFeatures,r=e.features,o=j(e,w),n=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).startIndex,i=arguments.length>2?arguments[2]:void 0;return i>t&&i===n+r.length&&t===r.length?C(C({},o),{},{features:r,totalFeatures:i}):C(C({},o),{},{features:r,totalFeatures:t})}(e.data,function(){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).pagination||!s()(e.startIndex)&&!s()(e.maxFeatures)&&{startIndex:e.startIndex,maxFeatures:e.maxFeatures}}(t,r),r.totalFeatures)}))},A=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.search,r=void 0===t?{}:t,o=e.url,n=e.name,i=arguments.length>1?arguments[1]:void 0,l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s=l.sortOptions,u=l.propertyName,c=j(l,F);return M(r.url||o,i&&"object"===S(i)?C(C({},i),{},{typeName:n||i.typeName}):N(q(n,[].concat(P(s?[D(s.sortBy,s.sortOrder)]:[]),P(u?[_(u)]:[]),P(i?a()(i):[]))),c),c).catch((function(e){if("OGCError"===e.name&&"NoApplicableCode"===e.code&&!s&&u&&u[0])return M(r.url||o,i&&"object"===S(i)?C(C({},i),{},{typeName:n||i.typeName}):N(q(n,[D(u[0])].concat(P(u?[_(u)]:[]),P(i?a()(i):[]))),c),c);throw e}))},k=function(e){var t=e.layer;return f().Observable.defer((function(){return b().get(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.name,r=e.search,o=void 0===r?{}:r,i=e.url,a=e.describeFeatureTypeURL,l=n().parse(a||o.url||i,!0);return n().format(C(C({},l),{},{search:void 0,query:C(C({},l.query),{},{service:"WFS",version:"1.1.0",typeName:t,outputFormat:"application/json",request:"DescribeFeatureType"})}))}(t))})).let(h.oB)},R=function(e){var t=e.layer;return f().Observable.defer((function(){return b().get(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.name,r=e.search,o=void 0===r?{}:r,i=e.url,a=(0,v.Fh)({name:t,url:o&&o.url||i}),l=n().parse(a,!0);return n().format(C(C({},l),{},{search:void 0,query:C(C({},l.query),{},{service:"WFS",version:"1.1.1",request:"GetCapabilities"})}))}(t))})).let(h.oB).switchMap((function(e){return f().Observable.bindNodeCallback((function(e,t){return(0,d.parseString)(e,{tagNameProcessors:[y.stripPrefix],explicitArray:!1,mergeAttrs:!0},t)}))(e.data)}))}},53637:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>co});var o=r(18446),n=r.n(o),i=r(75263),a=r.n(i),l=r(24852),s=r.n(l),u=r(71703),c=r(6806),p=r(12838),f=r(22222),d=r(82904),y=r(4206),m=r(90825),b=r(40512),g=r(80416),v=r(1550),h=r(7878),O=r(95797),w=r(93379),F=r.n(w),P=r(49469);F()(P.Z,{insert:"head",singleton:!1}),P.Z.locals;var E=r(72986),S=r.n(E),j=r(65539),x=r(5346),C=r(12346),T=r(80681),N=r(43129),q=r(20),D=function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).item;return s().createElement("span",null,e&&e.name?s().createElement(x.Z,{msgId:e.name}):null)};const _=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.spatialOperations,r=void 0===t?[]:t,o=e.onChange,n=void 0===o?function(){}:o,i=e.value;return s().createElement(q.DropdownList,{valueField:"id",className:"geometry-operation-selector",onChange:n,data:r,valueComponent:D,value:i,itemComponent:D})};var I=r(31071),L=r(11847),M=r(2576);function A(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,o=new Array(t);r<t;r++)o[r]=e[r];return o}var k=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.search,o=t.url;return(0,L.w0)(e,o)||(0,L.w0)(e,r&&r.url)},R=function(e){return(e||[]).filter((function(){return"BBOX"!==(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).id}))},B=r(27361),Z=r.n(B),G=r(13311),V=r.n(G),U=r(49977),z=r.n(U),W=r(86850),H=r(78889),Q={"xsd:normalizedString":"string","xsd:string":"string","xsd:date":"date","xsd:dateTime":"date","xsd:date-time":"date-time","xsd:time":"time","xsd:decimal":"number","xsd:int":"number","xsd:integer":"number","xsd:long":"number","xsd:negativeInteger":"number","xsd:nonNegativeInteger":"number","xsd:nonPositiveInteger":"number","xsd:positiveInteger":"number","xsd:short":"number","xsd:unsignedLong":"number","xsd:unsignedInt":"number","xsd:unsignedShort":"number","xsd:number":"number","xsd:boolean":"boolean","xsd:double":"number","xsd:float":"number","xsd:array":"array"},$=function(e){return Z()(e,"featureTypes[0].properties").filter((function(e){return 0!==e.type.indexOf("gml:")&&Q[e.type]})).map((function(e){return{label:e.name,attribute:e.name,type:Q[e.type],valueId:"id",valueLabel:"name",values:[]}}))},X=r(67076),J=r(73849);function Y(e){return Y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Y(e)}function K(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function ee(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?K(Object(r),!0).forEach((function(t){te(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):K(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function te(e,t,r){var o;return o=function(e,t){if("object"!=Y(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,"string");if("object"!=Y(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(t),(t="symbol"==Y(o)?o:o+"")in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const re=(0,X.compose)((0,X.withPropsOnChange)(["crossLayerFilter"],(function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).crossLayerFilter,t=void 0===e?{}:e;return{queryCollection:Z()(t,"collectGeometries.queryCollection"),operation:Z()(t,"operation"),distance:Z()(t,"distance")}})),(0,X.withProps)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.layers,r=void 0===t?[]:t,o=e.queryCollection,n=void 0===o?{}:o;return{layer:V()(r,(function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).name===n.typeName}))}})),(0,X.withHandlers)({setQueryCollectionParameter:function(e){var t=e.setCrossLayerFilterParameter,r=void 0===t?function(){}:t;return function(e,t){r("collectGeometries.queryCollection[".concat(e,"]"),t),"typeName"===e&&r("collectGeometries.queryCollection.filterFields",[])}},updateLogicCombo:function(e){var t=e.setCrossLayerFilterParameter,r=void 0===t?function(){}:t;return function(e,t){return r("collectGeometries.queryCollection.groupFields",[{id:e,logic:t,index:0}])}},setOperation:function(e){var t=e.setCrossLayerFilterParameter,r=void 0===t?function(){}:t;return function(e){return r("operation",e)}}}),(0,X.defaultProps)({dataStreamFactory:function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).setQueryCollectionParameter,r=void 0===t?function(){}:t;return function(e){return e.distinctUntilChanged((function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).searchUrl===(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).searchUrl})).switchMap((function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t.crossLayerExpanded?U.Observable.of(t):e.filter((function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).crossLayerExpanded})).take(1)})).switchMap((function(e){var t=e.featureTypeName,r=e.searchUrl;return(0,W.ED)({layer:{name:t,url:r,search:{type:"wfs",url:r}}}).do((function(e){if(t=e,r=Z()(t,"WFS_Capabilities.Filter_Capabilities.Scalar_Capabilities.ArithmeticOperators.Functions.FunctionNames.FunctionName"),!V()(r,(function(){return"queryCollection"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})._})))throw new Error("nocrosslayerfunctionalities");var t,r})).map((function(){return{loadingCapabilities:!1}})).catch((function(e){return U.Observable.of({errorObj:e,loadingAttributes:!1,loadingCapabilities:!1,featureTypeProperties:[]})})).startWith({loadingCapabilities:!0})})).startWith({})}(e).combineLatest(function(e,t){return e.distinctUntilChanged((function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).layer,t=void 0===e?{}:e,r=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).layer;return r&&t.name===(r&&r.name)})).filter((function(){return!!(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).layer})).switchMap((function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).layer;return U.Observable.defer((function(){return(0,W.v$)({layer:e})})).do((function(e){var r=Z()((0,H.findGeometryProperty)(e.data||{}),"name");r&&t("geometryName",r)})).map((function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).data;return $(void 0===e?{}:e)})).map((function(e){return{attributes:e,loadingAttributes:!1}})).startWith({loadingAttributes:!0}).catch((function(e){return U.Observable.of({errorObj:e,loadingAttributes:!1,featureTypeProperties:[]})}))})).catch((function(e){return U.Observable.of({errorObj:e,loadingAttributes:!1,loadingCapabilities:!1,featureTypeProperties:[]})})).startWith({})}(e,r),(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return ee(ee({},arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}),e)})).startWith({})}}),J.Z);var oe=r(43614),ne=r(47805),ie=r(38560),ae=r(80717);function le(e){return le="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},le(e)}function se(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,ye(o.key),o)}}function ue(e,t,r){return t=pe(t),function(e,t){if(t&&("object"===le(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,ce()?Reflect.construct(t,r||[],pe(e).constructor):t.apply(e,r))}function ce(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(ce=function(){return!!e})()}function pe(e){return pe=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},pe(e)}function fe(e,t){return fe=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},fe(e,t)}function de(e,t,r){return(t=ye(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ye(e){var t=function(e,t){if("object"!=le(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,"string");if("object"!=le(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==le(t)?t:t+""}var me=function(e){function t(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),de(r=ue(this,t,[e]),"getCurrentFilter",(function(){return{featureTypeName:r.props.featureTypeName,groupFields:r.props.groupFields,filterFields:r.props.sendFilters&&r.props.sendFilters.attributeFilter&&r.props.filterFields.filter((function(e){return(0,ne.checkOperatorValidity)(e.value,e.operator)}))||[],spatialField:r.props.sendFilters&&r.props.sendFilters.spatialFilter&&r.props.spatialField||{attribute:r.props.spatialField&&r.props.spatialField.attribute},pagination:r.props.pagination,filterType:r.props.filterType,ogcVersion:r.props.ogcVersion,sortOptions:r.props.sortOptions,crossLayerFilter:r.props.sendFilters&&r.props.sendFilters.crossLayerFilter&&(0,ne.setupCrossLayerFilterDefaults)(r.props.crossLayerFilter)||null,hits:r.props.hits}})),de(r,"isCurrentFilterChanged",(function(){var e=r.getCurrentFilter(),t={groupFields:e.groupFields,filterFields:e.filterFields,spatialField:e.spatialField,crossLayerFilter:e.crossLayerFilter},o=r.props.appliedFilter||{},i={groupFields:o.groupFields,filterFields:o.attributePanelExpanded&&o.filterFields||[],spatialField:o.spatialPanelExpanded&&o.spatialField||{attribute:r.props.spatialField&&r.props.spatialField.attribute},crossLayerFilter:o.crossLayerExpanded&&o.crossLayerFilter&&o.crossLayerFilter.operation?(0,ne.setupCrossLayerFilterDefaults)(o.crossLayerFilter):null};return!n()(t,i)})),de(r,"search",(function(){var e=r.getCurrentFilter();r.props.actions.onQuery(r.props.searchUrl,e,r.props.params),r.props.advancedToolbar&&r.props.actions.storeAppliedFilter()})),de(r,"reset",(function(){if(r.props.actions.onChangeDrawingStatus("clean","","queryform",[]),r.props.actions.onReset(),r.props.advancedToolbar){var e={featureTypeName:r.props.featureTypeName,groupFields:[],filterFields:[],spatialField:{attribute:r.props.spatialField&&r.props.spatialField.attribute},pagination:r.props.pagination,filterType:r.props.filterType,ogcVersion:r.props.ogcVersion,sortOptions:r.props.sortOptions,crossLayerFilter:null,hits:r.props.hits};r.props.actions.onQuery(r.props.searchUrl,e,r.props.params),r.props.advancedToolbar&&r.props.actions.storeAppliedFilter()}})),de(r,"restorePersistedFilter",(function(){r.props.actions.onRestoreFilter()})),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&fe(e,t)}(t,e),r=t,(o=[{key:"render",value:function(){var e=this,t=this.props.filterFields.filter((function(e){return e.exception})).length>0,r=this.props.allowEmptyFilter&&!this.props.advancedToolbar,o=this.props.filterFields.filter((function(e){return e.value||0===e.value})).length>0,i=(0,ne.isFilterEmpty)(this.props),a=(0,ne.isFilterEmpty)(this.props.appliedFilter),l=this.isCurrentFilterChanged(),u=o||this.props.spatialField.geometry||(0,ne.isCrossLayerFilterValid)(this.props.crossLayerFilter),c=!n()(this.props.appliedFilter,this.props.storedFilter),p=r||i&&this.props.appliedFilter&&!a,f=t||!this.props.toolbarEnabled||i&&!p||!i&&(!u||!l),d=this.props.emptyFilterWarning&&i&&l,y=this.props.advancedToolbar?"queryform.apply":this.props.queryBtnMsgId,m=[{tooltipId:d?"queryform.emptyfilter":y,disabled:f,noTooltipWhenDisabled:!0,glyph:this.props.advancedToolbar?"ok":this.props.queryBtnGlyph,className:d?"square-button-md showWarning":"square-button-md",id:"query-toolbar-query",onClick:this.search}];if(this.props.advancedToolbar){var b=!c||this.props.loadingError||l,g=!c||!this.props.storedFilter||!this.props.toolbarEnabled,v=!this.props.appliedFilter||this.props.appliedFilter&&a||!this.props.toolbarEnabled;m=m.concat([{tooltipId:"queryform.save",disabled:b,noTooltipWhenDisabled:!0,glyph:"floppy-disk",id:"query-toolbar-save",onClick:this.props.actions.onSaveFilter},{tooltipId:"queryform.discard",disabled:g,noTooltipWhenDisabled:!0,glyph:"undo",id:"query-toolbar-discard",onClick:this.restorePersistedFilter},{tooltipId:"queryform.reset",glyph:"clear-filter",noTooltipWhenDisabled:!0,id:"reset",disabled:v,onClick:this.reset}])}else m=[{tooltipId:"queryform.reset",glyph:"clear-filter",noTooltipWhenDisabled:!0,id:"reset",disabled:!this.props.toolbarEnabled,onClick:this.reset}].concat(m);return s().createElement("div",{className:"container-fluid query-toolbar"},s().createElement(ae.Z,{btnDefaultProps:{bsStyle:"primary",className:"square-button-md",tooltipPosition:"bottom"},className:"queryFormToolbar row-fluid pull-right",buttons:m}),s().createElement(oe.Z,{show:!!this.props.showGeneratedFilter,bsSize:"large"},s().createElement(oe.Z.Header,null,s().createElement(oe.Z.Title,null,this.props.resultTitle)),s().createElement(oe.Z.Body,null,s().createElement("textarea",{style:{width:"862px",maxWidth:"862px",height:"236px",maxHeight:"236px"}},this.props.showGeneratedFilter)),s().createElement(oe.Z.Footer,null,s().createElement(ie.Z,{style:{float:"right"},onClick:function(){return e.props.actions.onQuery(null,null)}},"Close"))))}}])&&se(r.prototype,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,o}(s().Component);de(me,"propTypes",{filterType:a().string,params:a().object,filterFields:a().array,groupFields:a().array,spatialField:a().object,sendFilters:a().object,crossLayerFilter:a().object,toolbarEnabled:a().bool,searchUrl:a().string,showGeneratedFilter:a().oneOfType([a().bool,a().string]),featureTypeName:a().string,actions:a().object,ogcVersion:a().string,titleMsgId:a().string,queryBtnMsgId:a().string,resultTitle:a().string,queryBtnGlyph:a().string,pagination:a().object,sortOptions:a().object,hits:a().bool,allowEmptyFilter:a().bool,emptyFilterWarning:a().bool,appliedFilter:a().object,storedFilter:a().object,advancedToolbar:a().bool,loadingError:a().bool}),de(me,"defaultProps",{sendFilters:{attributeFilter:!0,spatialFilter:!0,crossLayerFilter:!0},filterType:"OGC",params:{},groupFields:[],filterFields:[],spatialField:{},toolbarEnabled:!0,searchUrl:null,showGeneratedFilter:!1,featureTypeName:null,titleMsgId:"queryform.title",queryBtnMsgId:"queryform.query",resultTitle:"Generated Filter",queryBtnGlyph:"search",pagination:null,sortOptions:null,hits:!1,allowEmptyFilter:!1,emptyFilterWarning:!1,advancedToolbar:!1,loadingError:!1,actions:{onQuery:function(){},onReset:function(){},onChangeDrawingStatus:function(){},onSaveFilter:function(){},onRestoreFilter:function(){},storeAppliedFilter:function(){}}});const be=me;var ge=r(14293),ve=r.n(ge),he=r(76364),Oe=r(86638),we=r(38167),Fe=r(94192),Pe=r(1469),Ee=r.n(Pe),Se=r(28878),je=r(59286),xe=r(91175),Ce=r.n(xe),Te=r(50966),Ne=r(48384);function qe(e){return qe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},qe(e)}function De(){return De=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},De.apply(this,arguments)}function _e(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,Re(o.key),o)}}function Ie(e,t,r){return t=Me(t),function(e,t){if(t&&("object"===qe(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,Le()?Reflect.construct(t,r||[],Me(e).constructor):t.apply(e,r))}function Le(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Le=function(){return!!e})()}function Me(e){return Me=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Me(e)}function Ae(e,t){return Ae=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Ae(e,t)}function ke(e,t,r){return(t=Re(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Re(e){var t=function(e,t){if("object"!=qe(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,"string");if("object"!=qe(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==qe(t)?t:t+""}var Be=function(e){function t(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,o=new Array(r),n=0;n<r;n++)o[n]=arguments[n];return ke(e=Ie(this,t,[].concat(o)),"state",{}),ke(e,"renderWithTooltip",(function(t){if(e.props.tooltip.customizedTooltip){var r=e.props.tooltip.customizedTooltip;return s().createElement(r,null,t)}var o=s().createElement(T.Tooltip,{id:e.props.tooltip.id},"this.props.tooltip.message");return s().createElement(Te.Z,{key:e.props.tooltip.overlayTriggerKey,placement:e.props.tooltip.placement,overlay:o},t)})),ke(e,"renderPagination",(function(){var t=e.props.pagination.firstPage,r=e.props.pagination.lastPage;return s().createElement("div",{className:"autocomplete-toolbar"},!t&&s().createElement(T.Glyphicon,{className:e.props.prevPageIcon,glyph:e.props.prevPageIcon,onClick:function(){return e.props.pagination.loadPrevPage()}}),!r&&s().createElement(T.Glyphicon,{className:e.props.nextPageIcon,glyph:e.props.nextPageIcon,onClick:function(){return e.props.pagination.loadNextPage()}}))})),ke(e,"renderField",(function(){var t={emptyList:function(){return e.props.busy?"Loading...":(0,Oe.S$)(e.context.messages,"queryform.attributefilter.autocomplete.emptyList")},open:(0,Oe.S$)(e.context.messages,"queryform.attributefilter.autocomplete.open"),emptyFilter:(0,Oe.S$)(e.context.messages,"queryform.attributefilter.autocomplete.emptyFilter")},r=[];e.props.data&&e.props.data.length>0&&(r=e.props.data.map((function(e){return e}))),e.props.pagination&&e.props.pagination.paginated&&r.length>0&&r.push(ke(ke(ke(ke({},e.props.textField,""),e.props.valueField,""),"disabled",!0),"pagination",e.renderPagination()));var o=!1,n=e.props.loading?[]:r,i=e.props.itemComponent,a=s().createElement(q.Combobox,{dropUp:e.props.dropUp,busy:e.props.busy,data:n,disabled:e.props.disabled,itemComponent:function(t){return s().createElement(i,De({textField:e.props.textField,valueField:e.props.valueField},t))},messages:e.props.messages||t,open:e.props.open,filter:!1,onChange:function(t){e.props.onChange(t,e.props.valueField),o=!0},onFocus:function(){return e.props.onFocus(e.props.data)},onSelect:function(t){var r=Ce()(e.props.features.filter((function(r){return r.properties[e.props.valueField].toLowerCase()===t[e.props.valueField].toLowerCase()})));e.props.onSelect(t,r,e.props.srsName,e.props.style)},onToggle:function(t){var r=Ce()(e.props.features.filter((function(t){return t.properties[e.props.valueField].toLowerCase()===e.props.selectedValue.toLowerCase()})));!t||e.props.selectedValue||e.props.selectedValue||o||e.props.onChange("",e.props.valueField),e.props.onToggle(t,r,e.props.pagination.currentPage),r&&!t&&e.props.onSelect(e.props.selectedValue,r,e.props.srsName,e.props.style),o=!1},textField:e.props.textField,valueField:e.props.valueField,value:e.props.selectedValue});return e.props.tooltip&&e.props.tooltip.enabled?e.renderWithTooltip(a):a})),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ae(e,t)}(t,e),r=t,(o=[{key:"render",value:function(){var e=this.props.label?s().createElement("label",null,this.props.label):s().createElement("span",null);return s().createElement("div",{className:"autocompleteField"},e,this.renderField())}}])&&_e(r.prototype,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,o}(s().Component);ke(Be,"propTypes",{busy:a().bool,data:a().array,disabled:a().bool,dropUp:a().bool,features:a().array,filter:a().string,itemComponent:a().oneOfType([a().object,a().func]),label:a().string,loading:a().bool,messages:a().object,onChange:a().func,onFocus:a().func,onSelect:a().func,onToggle:a().func,onChangeDrawingStatus:a().func,style:a().style,open:a().bool,pagination:a().object,nextPageIcon:a().string,prevPageIcon:a().string,selectedValue:a().string,srsName:a().string,textField:a().string,tooltip:a().object,valueField:a().string}),ke(Be,"contextTypes",{messages:a().object}),ke(Be,"defaultProps",{dropUp:!1,features:[],filter:"",itemComponent:Ne.Z,loading:!1,label:null,pagination:{paginated:!0,firstPage:!1,lastPage:!1,loadPrevPage:function(){},loadNextPage:function(){}},nextPageIcon:"chevron-right",prevPageIcon:"chevron-left",onFocus:function(){},onToggle:function(){},onChange:function(){},onChangeDrawingStatus:function(){},onSelect:function(){},srsName:"EPSG:4326",textField:"label",tooltip:{customizedTooltip:void 0,enabled:!1,id:"",message:void 0,overlayTriggerKey:"",placement:"top"},valueField:"value"});const Ze=Be;function Ge(e){return Ge="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ge(e)}function Ve(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function Ue(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ve(Object(r),!0).forEach((function(t){ze(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ve(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function ze(e,t,r){var o;return o=function(e,t){if("object"!=Ge(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,"string");if("object"!=Ge(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(t),(t="symbol"==Ge(o)?o:o+"")in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}(0,X.setObservableConfig)(Se.Z);var We=(0,X.mapPropsStreamWithConfig)(Se.Z)((function(e){return e.take(1).switchMap((function(t){return t.autocompleteStreamFactory(e)})).combineLatest(e,(function(e,t){return Ue(Ue({},t),{},{data:Ee()(e&&e.fetchedData&&e.fetchedData.values)?e.fetchedData.values:[],features:Ee()(e&&e.fetchedData&&e.fetchedData.features)?e.fetchedData.features:[],valuesCount:e&&e.fetchedData&&e.fetchedData.size,srsName:e&&e.fetchedData&&e.fetchedData.crs,busy:e.busy})}))}))((function(e){var t=e.open,r=e.toggle,o=e.select,n=e.focus,i=e.change,a=e.changed,l=e.originalValue,u=e.value,c=e.valuesCount,p=e.onChangeDrawingStatus,f=e.loadNextPage,d=e.loadPrevPage,y=e.maxFeatures,m=e.currentPage,b=e.itemComponent,g=e.features,v=e.busy,h=e.data,O=e.loading,w=void 0!==O&&O,F=e.valueField,P=e.textField,E=e.filter,S=e.srsName,j=e.style,x=Math.ceil(c/y);return s().createElement(Ze,{pagination:{firstPage:1===m,lastPage:x<=m,paginated:!0,loadPrevPage:d,loadNextPage:f,currentPage:m},srsName:S,busy:v,dropUp:!1,data:h,open:t,onChangeDrawingStatus:p,valueField:F,textField:P,itemComponent:b,filter:E,onFocus:n,onToggle:r,onChange:i,onSelect:o,features:g,style:j,selectedValue:a?u:l||u,loading:w})})),He=(0,X.compose)((0,X.withPropsOnChange)(["valueField"],(function(){return{value:void 0}})),(0,X.withStateHandlers)((function(e){return{delayDebounce:0,performFetch:!1,open:!1,currentPage:1,maxFeatures:5,changed:e.value,value:e.value,onChangeDrawingStatus:e.onChangeDrawingStatus,itemComponent:e.itemComponent}}),{select:function(){return function(e){return{selected:e}}},change:function(e){return function(t,r){return e.selected||e.open||e.onChangeDrawingStatus("clean","","queryform",[],{}),{delayDebounce:500,selected:!1,changingPage:!1,changed:!0,performFetch:!(e.selected&&!e.changingPage),value:e.selected&&e.changingPage&&e.value||("string"==typeof t?t:t[r]),currentPage:e.changingPage?e.currentPage:1}}},focus:function(e){return function(t){return t&&0===t.length&&""===e.value?{delayDebounce:0,currentPage:1,performFetch:!0,isToggled:!1,open:!0}:e}},toggle:function(e){return function(){return{open:!!e.changingPage||!e.open}}},loadNextPage:function(e){return function(){return{currentPage:e.currentPage+1,performFetch:!0,changingPage:!0,delayDebounce:0}}},loadPrevPage:function(e){return function(){return{currentPage:e.currentPage-1,performFetch:!0,changingPage:!0,delayDebounce:0}}}}),(0,X.withHandlers)({select:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.options,r=e.onChangeSpatialFilterValue,o=void 0===r?function(){}:r,n=e.select,i=void 0===n?function(){}:n;return function(e,r,n,a){r&&o({geometry:r.geometry,value:e,feature:r,srsName:n,style:a,options:t,collectGeometries:t&&t.crossLayer?{queryCollection:{typeName:t.crossLayer.typeName,geometryName:t.crossLayer.geometryName,cqlFilter:(0,je.generateTemplateString)(t.crossLayer.cqlTemplate||"",ne.escapeCQLStrings)(r)}}:void 0}),i(!0)}}})),Qe=He(We),$e=r(4201);function Xe(e){return Xe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Xe(e)}function Je(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,rt(o.key),o)}}function Ye(e,t,r){return t=et(t),function(e,t){if(t&&("object"===Xe(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,Ke()?Reflect.construct(t,r||[],et(e).constructor):t.apply(e,r))}function Ke(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Ke=function(){return!!e})()}function et(e){return et=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},et(e)}function tt(e,t){return tt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},tt(e,t)}function rt(e){var t=function(e,t){if("object"!=Xe(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,"string");if("object"!=Xe(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Xe(t)?t:t+""}var ot,nt,it,at=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Ye(this,t,arguments)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&tt(e,t)}(t,e),r=t,(o=[{key:"render",value:function(){return s().createElement("span",{className:this.props.customItemClassName?this.props.customItemClassName:""},this.props.item)}}])&&Je(r.prototype,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,o}(s().Component);ot=at,nt="propTypes",it={item:a().string,textField:a().string,customItemClassName:a().string,valueField:a().string},(nt=rt(nt))in ot?Object.defineProperty(ot,nt,{value:it,enumerable:!0,configurable:!0,writable:!0}):ot[nt]=it;const lt=at;var st=r(27418),ut=r.n(st),ct=r(86267);function pt(e){return pt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},pt(e)}function ft(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,vt(o.key),o)}}function dt(e,t,r){return t=mt(t),function(e,t){if(t&&("object"===pt(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,yt()?Reflect.construct(t,r||[],mt(e).constructor):t.apply(e,r))}function yt(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(yt=function(){return!!e})()}function mt(e){return mt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},mt(e)}function bt(e,t){return bt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},bt(e,t)}function gt(e,t,r){return(t=vt(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function vt(e){var t=function(e,t){if("object"!=pt(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,"string");if("object"!=pt(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==pt(t)?t:t+""}var ht=function(e){function t(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,o=new Array(r),n=0;n<r;n++)o[n]=arguments[n];return gt(e=dt(this,t,[].concat(o)),"onUpdateBBOX",(function(t,r){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"replace";"replace"===o&&(e.tempExtent[r]=!isNaN(parseFloat(t))&&parseFloat(t)||0);var n=[];for(var i in e.tempExtent)i&&n.push(e.tempExtent[i]);var a=(0,ct.reprojectBbox)(n,"EPSG:4326",e.props.projection),l={type:e.props.geometry.type,coordinates:[[[a[0],a[1]],[a[0],a[3]],[a[2],a[3]],[a[2],a[1]],[a[0],a[1]]]],projection:e.props.geometry.projection};e.props.onChangeDrawingStatus(o,void 0,"queryform",[l])})),gt(e,"onUpdateCircle",(function(t,r){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"replace";"replace"===o&&(e.tempCircle[r]=parseFloat(t));var n=isNaN(parseFloat(e.tempCircle.x))||isNaN(parseFloat(e.tempCircle.y))?[e.tempCircle.x,e.tempCircle.y]:(0,ct.reproject)([e.tempCircle.x,e.tempCircle.y],"EPSG:4326",e.props.projection);n=void 0===n.x?{x:n[0],y:n[1]}:n;var i={x:isNaN(n.x)?0:n.x,y:isNaN(n.y)?0:n.y},a={type:e.props.geometry.type,center:i,coordinates:[i.x,i.y],radius:isNaN(e.tempCircle.radius)?0:e.tempCircle.radius,projection:e.props.geometry.projection};e.props.onChangeDrawingStatus(o,void 0,"queryform",[a],{geodesic:e.props.enableGeodesic})})),gt(e,"onModifyGeometry",(function(){"BBOX"===e.props.type?e.onUpdateBBOX(null,null,"endDrawing"):"Circle"===e.props.type&&e.onUpdateCircle(null,null,"endDrawing"),e.props.onShowPanel(!1)})),gt(e,"onClosePanel",(function(){e.resetGeom(),e.props.onShowPanel(!1)})),gt(e,"getStep",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return Math.min(1/Math.pow(10,Math.ceil(Math.min(e,21)/3)-2),1)})),gt(e,"getStepCircle",(function(t,r){var o=e.getStep(t);return"radius"===r&&!e.isWGS84()&&1e4*o||o})),gt(e,"getBBOXDimensions",(function(e){var t=(0,ct.reprojectBbox)(e.extent,e.projection,"EPSG:4326");return{west:t[0],sud:t[1],est:t[2],north:t[3]}})),gt(e,"getCircleDimensions",(function(t){var r=(0,ct.reproject)(t.center,t.projection,"EPSG:4326"),o=(0,ct.reproject)(t.center,t.projection,e.props.projection),n=(0,ct.reproject)([t.center[0]+t.radius,t.center[1]],t.projection,e.props.projection),i=Math.sqrt((n.x-o.x)*(n.x-o.x)+(n.y-o.y)*(n.y-o.y));return{x:r.x,y:r.y,radius:i}})),gt(e,"renderCoordinateField",(function(t,r){return s().createElement("div",null,s().createElement("div",{className:"detail-field-title"},r),s().createElement(Fe.Z,{style:{minWidth:"105px",margin:"auto"},type:"number",id:"queryform_bbox_"+r,step:e.getStep(e.props.zoom),defaultValue:e.roundValue(t,1e6),onChange:function(t){return e.onUpdateBBOX(t,r)}}))})),gt(e,"renderCircleField",(function(t,r){return s().createElement(Fe.Z,{type:"number",id:"queryform_circle_"+r,defaultValue:e.roundValue(t,"radius"!==r||e.isWGS84()?1e6:100),step:e.getStepCircle(e.props.zoom,r),onChange:function(t){return e.onUpdateCircle(t,r)}})})),gt(e,"renderDetailsContent",(function(){var t,r=e.props.geometry;if("BBOX"===e.props.type){var o=e.getBBOXDimensions(r);t=s().createElement("div",null,s().createElement("div",{className:"container-fluid"},s().createElement(T.Row,null,s().createElement(T.Col,{xs:4},s().createElement("span",null)),s().createElement(T.Col,{xs:4},e.renderCoordinateField(o.north,"north")),s().createElement(T.Col,{xs:4},s().createElement("span",null))),s().createElement(T.Row,null,s().createElement(T.Col,{xs:4},e.renderCoordinateField(o.west,"west")),s().createElement(T.Col,{xs:4},s().createElement("span",null)),s().createElement(T.Col,{xs:4},e.renderCoordinateField(o.est,"est"))),s().createElement(T.Row,null,s().createElement(T.Col,{xs:4},s().createElement("span",null)),s().createElement(T.Col,{xs:4},e.renderCoordinateField(o.sud,"sud")),s().createElement(T.Col,{xs:4},s().createElement("span",null)))),s().createElement("span",null,s().createElement("hr",{width:"90%"}),s().createElement("div",null,s().createElement("h5",null,s().createElement(we.ZP.Message,{msgId:"queryform.spatialfilter.details.details_bbox_label"})))))}else if("Circle"===e.props.type){var n=e.getCircleDimensions(r),i=(0,ct.getUnits)(e.props.projection);t=s().createElement("div",null,s().createElement("div",{className:"container-fluid"},s().createElement(T.Row,null,s().createElement(T.Col,{xs:2},s().createElement("span",null)),s().createElement(T.Col,{xs:2},s().createElement("span",{className:"details-circle-attribute-name"},"x:")),s().createElement(T.Col,{xs:4},e.renderCircleField(n.x,"x")),s().createElement(T.Col,{xs:4},s().createElement("span",null))),s().createElement(T.Row,null,s().createElement(T.Col,{xs:2},s().createElement("span",null)),s().createElement(T.Col,{xs:2},s().createElement("span",{className:"details-circle-attribute-name"},"y:")),s().createElement(T.Col,{xs:4},e.renderCircleField(n.y,"y")),s().createElement(T.Col,{xs:4},s().createElement("span",null))),s().createElement(T.Row,null,s().createElement(T.Col,{xs:2},s().createElement("span",null)),s().createElement(T.Col,{xs:2},s().createElement("span",{className:"details-circle-attribute-name"},s().createElement(we.ZP.Message,{msgId:"queryform.spatialfilter.details.radius",msgParams:{unit:"degrees"===i?"°":i}}),":")),s().createElement(T.Col,{xs:4},e.renderCircleField(n.radius,"radius")),s().createElement(T.Col,{xs:4},s().createElement("span",null)))),s().createElement("span",null,s().createElement("hr",{width:"90%"}),s().createElement("div",null,s().createElement("h5",null,s().createElement(we.ZP.Message,{msgId:"queryform.spatialfilter.details.details_circle_label"})))))}return t})),gt(e,"isWGS84",(function(){return"EPSG:4326"===e.props.projection})),gt(e,"roundValue",(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e6;return Math.round(e*t)/t})),gt(e,"resetGeom",(function(){"BBOX"===e.props.type?e.resetBBOX():"Circle"===e.props.type&&e.resetCircle()})),gt(e,"resetBBOX",(function(){for(var t in e.extent)t&&(document.getElementById("queryform_bbox_"+t).value=e.roundValue(e.extent[t],1e6),e.onUpdateBBOX(e.extent[t],t))})),gt(e,"resetCircle",(function(){document.getElementById("queryform_circle_radius").value=e.roundValue(e.circle.radius,100),e.onUpdateCircle(e.circle.radius,"radius"),document.getElementById("queryform_circle_x").value=e.roundValue(e.circle.x,e.isWGS84()?1e6:100),e.onUpdateCircle(e.circle.x,"x"),document.getElementById("queryform_circle_y").value=e.roundValue(e.circle.y,e.isWGS84()?1e6:100),e.onUpdateCircle(e.circle.y,"y")})),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&bt(e,t)}(t,e),r=t,(o=[{key:"componentDidMount",value:function(){var e=this.props.geometry;"BBOX"===this.props.type?(this.extent=this.getBBOXDimensions(e),this.tempExtent=ut()({},this.extent)):"Circle"===this.props.type&&(this.circle=this.getCircleDimensions(e),this.tempCircle=ut()({},this.circle))}},{key:"render",value:function(){var e=this;return s().createElement(C.Z,{buttons:[{key:"confirm",glyph:"ok",tooltipId:"confirm",onClick:function(){return e.onModifyGeometry()}},{key:"reset",tooltipId:"queryform.reset",glyph:"clear-filter",onClick:function(){return e.resetGeom()}},{key:"close",glyph:"1-close",onClick:function(){return e.onClosePanel(!1)}}],title:s().createElement(we.ZP.Message,{msgId:"queryform.spatialfilter.details.details_header"}),locked:!0,expanded:!0,className:"details-panel",bsStyle:"primary"},this.renderDetailsContent())}}])&&ft(r.prototype,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,o}(s().Component);gt(ht,"propTypes",{useMapProjection:a().bool,geometry:a().object,type:a().string,onShowPanel:a().func,onChangeDrawingStatus:a().func,zoom:a().number,projection:a().string,enableGeodesic:a().bool}),gt(ht,"defaultProps",{useMapProjection:!0,geometry:null,type:null,onShowPanel:function(){},onChangeDrawingStatus:function(){}});const Ot=ht;function wt(e){return wt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},wt(e)}function Ft(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,Ct(o.key),o)}}function Pt(e,t,r){return t=St(t),function(e,t){if(t&&("object"===wt(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,Et()?Reflect.construct(t,r||[],St(e).constructor):t.apply(e,r))}function Et(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Et=function(){return!!e})()}function St(e){return St=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},St(e)}function jt(e,t){return jt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},jt(e,t)}function xt(e,t,r){return(t=Ct(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ct(e){var t=function(e,t){if("object"!=wt(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,"string");if("object"!=wt(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==wt(t)?t:t+""}var Tt=function(e){function t(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,o=new Array(r),n=0;n<r;n++)o[n]=arguments[n];return xt(e=Pt(this,t,[].concat(o)),"state",{open:!1}),xt(e,"getFilter",(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"*",r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"=",o={filterFields:[{attribute:e.props.searchAttribute,operator:r,value:t,type:"list"}]};return e.props.dependsOn&&(o.groupFields=[{id:1,logic:"AND",index:0}],o.filterFields[0].groupId=1,e.props.multivalue?(o.groupFields.push({id:2,logic:"OR",groupId:1,index:1}),e.props.dependsOn.value instanceof Array?e.props.dependsOn.value.forEach((function(t){o.filterFields.push({attribute:e.props.dependsOn.field,operator:e.props.dependsOn.operator||"=",value:t,groupId:2,type:"list"})})):o.filterFields.push({attribute:e.props.dependsOn.field,operator:e.props.dependsOn.operator||"=",value:e.props.dependsOn.value,groupId:2,type:"list"})):o.filterFields.push({attribute:e.props.dependsOn.field,operator:e.props.dependsOn.operator||"=",value:e.props.dependsOn.value,groupId:1,type:"list"})),(0,ne.toOGCFilter)(e.props.typeName,o,e.props.wfs,e.props.sort||{sortBy:e.props.searchAttribute,sortOrder:"ASC"})})),xt(e,"changeZoneValue",(function(t,r,o){var n;e.setState({open:!1}),n=e.props.multivalue?{value:o.map((function(e){return e.id})),feature:o.map((function(e){return e.feature}))}:{value:[o],feature:[e.values.filter((function(e){return e.id===o}))[0].feature]},e.props.onChange(e.props.zoneId,n)})),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&jt(e,t)}(t,e),r=t,(o=[{key:"UNSAFE_componentWillReceiveProps",value:function(e){e.values&&!n()(this.props.values,e.values)&&e.values.length>0&&this.setState({open:!0})}},{key:"render",value:function(){var e=this;this.values=[],this.props.values&&this.props.values.length>0&&(this.values=this.props.values.map((function(t){var r=t;e.props.valueField.split(".").forEach((function(e){r=r?r[e]:null}));var o=t;return e.props.textField.split(".").forEach((function(e){o=o?o[e]:null})),{id:r,name:o,feature:t}})));var t=this.props.label?s().createElement("label",null,this.props.label):s().createElement("span",null),r=this.props.error;return r&&(r="object"!==wt(r)?r:r.status+" "+r.statusText+": "+r.data),s().createElement("div",{className:"zone-combo"},t,s().createElement($e.Z,{key:(new Date).getTime(),busy:this.props.busy,disabled:this.props.disabled,fieldRowId:this.props.zoneId,valueField:"id",textField:"name",fieldOptions:this.values,fieldValue:this.props.value,fieldName:"zone",fieldException:r,options:{defaultOpen:this.state.open},groupBy:this.props.groupBy?function(t){return t.feature.properties[e.props.groupBy]}:function(){},multivalue:this.props.multivalue,comboFilter:this.props.comboFilter,onSelect:this.props.onSelect,onUpdateField:this.changeZoneValue,onToggle:function(t){if(t&&(!e.props.values||e.props.values.length<1)){var r=e.getFilter(e.props.searchText,e.props.searchMethod);e.props.onSearch(!0,e.props.zoneId),e.props.onFilter(e.props.url,r,e.props.zoneId)}}}))}}])&&Ft(r.prototype,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,o}(s().Component);xt(Tt,"propTypes",{zoneId:a().number,url:a().string,typeName:a().string,wfs:a().string,busy:a().bool,values:a().array,value:a().oneOfType([a().object,a().number,a().string,a().array]),label:a().string,searchText:a().string,searchMethod:a().string,searchAttribute:a().string,sort:a().object,error:a().oneOfType([a().object,a().string]),comboFilter:a().oneOfType([a().bool,a().string,a().func]),groupBy:a().oneOfType([a().string,a().func]),multivalue:a().bool,open:a().bool,disabled:a().bool,dependsOn:a().object,valueField:a().string,textField:a().string,onSearch:a().func,onFilter:a().func,onChange:a().func,onSelect:a().func}),xt(Tt,"contextTypes",{messages:a().object}),xt(Tt,"defaultProps",{open:!1,zoneId:null,url:null,typeName:null,wfs:"1.1.0",busy:!1,values:[],value:null,valueField:null,textField:null,label:null,disabled:!1,error:null,searchText:"*",searchMethod:"ilike",searchAttribute:null,comboFilter:"contains",multivalue:!0,groupBy:null,onSearch:function(){},onFilter:function(){},onChange:function(){},onSelect:function(){}});const Nt=Tt;function qt(e){return qt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},qt(e)}function Dt(){return Dt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},Dt.apply(this,arguments)}function _t(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,Rt(o.key),o)}}function It(e,t,r){return t=Mt(t),function(e,t){if(t&&("object"===qt(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,Lt()?Reflect.construct(t,r||[],Mt(e).constructor):t.apply(e,r))}function Lt(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Lt=function(){return!!e})()}function Mt(e){return Mt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Mt(e)}function At(e,t){return At=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},At(e,t)}function kt(e,t,r){return(t=Rt(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Rt(e){var t=function(e,t){if("object"!=qt(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,"string");if("object"!=qt(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==qt(t)?t:t+""}var Bt=function(e){function t(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,o=new Array(r),n=0;n<r;n++)o[n]=arguments[n];return kt(e=It(this,t,[].concat(o)),"getMethodFromId",(function(t){return V()(e.props.spatialMethodOptions,(function(e){return e&&e.id===t}))||null})),kt(e,"renderHeader",(function(){var t=(0,Oe.S$)(e.context.messages,"queryform.spatialfilter.spatial_filter_header");return s().createElement("span",null,s().createElement("span",{style:{cursor:"pointer"},onClick:e.props.actions.onExpandSpatialFilterPanel.bind(null,!e.props.spatialPanelExpanded)},t))})),kt(e,"renderSpatialHeader",(function(){var t=e.getMethodFromId(e.props.spatialField.method);return s().createElement("div",null,s().createElement(T.Row,{className:"logicHeader inline-form filter-field-row filter-field-fixed-row"},s().createElement(T.Col,{xs:6},s().createElement("div",null,s().createElement(we.ZP.Message,{msgId:"queryform.spatialfilter.filterType"}))),s().createElement(T.Col,{xs:6},s().createElement($e.Z,{itemComponent:function(t){return s().createElement(lt,Dt({customItemClassName:e.getMethodFromId(t.item)&&e.getMethodFromId(t.item).customItemClassName||""},t))},fieldOptions:e.props.spatialMethodOptions.map((function(t){return(0,Oe.S$)(e.context.messages,t.name)||t.name})),placeholder:(0,Oe.S$)(e.context.messages,"queryform.spatialfilter.combo_placeholder"),fieldName:"method",fieldRowId:(new Date).getTime(),fieldValue:(0,Oe.S$)(e.context.messages,t?t.name:"")||t&&t.name||"",onUpdateField:e.updateSpatialMethod}))))})),kt(e,"renderDwithin",(function(){return s().createElement(T.Row,{className:"container-fluid filter-field-fixed-row"},s().createElement(T.Col,{xs:6,className:"filter-text-desc"},s().createElement(we.ZP.Message,{msgId:"queryform.spatialfilter.dwithin_label"})),s().createElement(T.Col,{xs:6},s().createElement(Fe.Z,{type:"number",min:"0",defaultValue:"0",disabled:!e.props.spatialField.geometry,id:"queryform_dwithin_field",onChange:function(t){return e.props.actions.onChangeDwithinValue(t,name)}})))})),kt(e,"renderZoneFields",(function(){return e.props.spatialField.method&&"ZONE"===e.props.spatialField.method&&e.props.spatialField.zoneFields&&e.props.spatialField.zoneFields.length>0?e.props.spatialField.zoneFields.map((function(t){return s().createElement(Nt,{key:t.id,open:t.open,zoneId:t.id,url:t.url,typeName:t.typeName,wfs:t.wfs,busy:t.busy,label:t.label,values:t.values,value:t.value,valueField:t.valueField,textField:t.textField,searchText:t.searchText,searchMethod:t.searchMethod,searchAttribute:t.searchAttribute,sort:t.sort,error:t.error,disabled:t.disabled,dependsOn:t.dependson,groupBy:t.groupBy,multivalue:t.multivalue,onSearch:e.props.actions.zoneSearch,onFilter:e.props.actions.zoneFilter,onChange:e.props.actions.zoneChange})})):null})),kt(e,"renderRoiPanel",(function(){var t=e.getMethodFromId(e.props.spatialField.method),r=t&&t.filterProps&&t.filterProps.valueField&&e.props.spatialField&&e.props.spatialField.value&&e.props.spatialField.value[t.filterProps.valueField];return s().createElement(T.Panel,null,s().createElement("div",{className:"container-fluid"},s().createElement(T.Row,{className:"filter-field-row filter-field-fixed-row"},s().createElement(T.Col,{xs:6},s().createElement("span",null,t&&t.name||t.id)),s().createElement(T.Col,{xs:6},s().createElement(Qe,{originalValue:r,key:e.props.spatialField.method,options:t,autocompleteStreamFactory:he.Vj,valueField:t&&t.filterProps&&t.filterProps.valueField,textField:t&&t.filterProps&&t.filterProps.valueField,url:t&&t.url,filter:"contains",onChangeSpatialFilterValue:e.props.actions.onChangeSpatialFilterValue,onChangeDrawingStatus:function(){var t;(t=e.props.actions).onChangeDrawingStatus.apply(t,arguments)},filterProps:t&&t.filterProps})))))})),kt(e,"renderSpatialPanel",(function(t,r,o){return s().createElement(T.Panel,{className:"spatial-panel"},e.props.spatialMethodOptions.length>1?e.renderSpatialHeader():s().createElement("span",null),e.renderZoneFields(),e.props.spatialField.method&&e.getMethodFromId(e.props.spatialField.method)&&"wfsGeocoder"===e.getMethodFromId(e.props.spatialField.method).type?e.renderRoiPanel():null,e.props.spatialOperations.length>1?s().createElement(T.Panel,null,s().createElement("div",null,t),o&&"DWITHIN"===o.id?e.renderDwithin():null,s().createElement(T.Row,null,s().createElement(T.Col,{xs:12},r))):s().createElement("span",null))})),kt(e,"renderButtons",(function(){var t=[],r=e.props.showDetailsButton&&e.props.spatialField.geometry&&(e.props.spatialField.method&&"BBOX"===e.props.spatialField.method||"Circle"===e.props.spatialField.method),o=e.props.spatialField.geometry&&e.props.spatialField.geometry.coordinates;return r&&t.push({glyph:"pencil",onClick:function(){return e.props.actions.onShowSpatialSelectionDetails(!0)},tooltipId:"queryform.spatialfilter.details.detail_button_label"}),o&&t.push({glyph:"clear-filter",tooltipId:"queryform.spatialfilter.remove",bsStyle:e.props.clearFilterOptions.buttonStyle,className:e.props.clearFilterOptions.className,onClick:function(){return e.resetSpatialFilter()}}),t})),kt(e,"updateSpatialMethod",(function(t,r,o){e.props.actions.onShowSpatialSelectionDetails(!1);var n=e.props.spatialMethodOptions.filter((function(t){return o===((0,Oe.S$)(e.context.messages,t.name)||t.name)}))[0].id,i=e.getMethodFromId(n);if(e.props.actions.onSelectSpatialMethod(n,r),"wfsGeocoder"!==e.getMethodFromId(n).type)switch(n){case"ZONE":e.changeDrawingStatus("clean","","queryform",[]);break;case"Viewport":e.changeDrawingStatus("clean","","queryform",[]),e.props.actions.onSelectViewportSpatialMethod();break;default:e.changeDrawingStatus("start",n,"queryform",[],{geodesic:!!ve()(i.geodesic)||i.geodesic,stopAfterDrawing:!0})}else e.changeDrawingStatus("clean","","queryform",[])})),kt(e,"updateSpatialOperation",(function(t,r,o){var n=e.props.spatialOperations.filter((function(t){return o===(0,Oe.S$)(e.context.messages,t.name)}))[0].id;e.props.actions.onSelectSpatialOperation(n,r)})),kt(e,"resetSpatialFilter",(function(){e.changeDrawingStatus("clean","","queryform",[]),e.props.actions.onRemoveSpatialSelection(),e.props.actions.onShowSpatialSelectionDetails(!1)})),kt(e,"changeDrawingStatus",(function(t,r,o,n,i){e.props.actions.onChangeDrawingStatus(t,void 0!==r?r:e.props.spatialField.method,o,n,i)})),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&At(e,t)}(t,e),r=t,(o=[{key:"render",value:function(){var e=this,t=this.props.spatialOperations.filter((function(t){return e.props.spatialField.operation===t.id}))[0],r=s().createElement("span",null);"ZONE"!==this.props.spatialField.method&&"Viewport"!==this.props.spatialField.method&&this.getMethodFromId(this.props.spatialField.method)&&"wfsGeocoder"!==this.getMethodFromId(this.props.spatialField.method).type&&(r=this.props.spatialField.geometry?null:s().createElement("span",null,s().createElement("div",{className:"m-label m-caption text-center"},s().createElement(we.ZP.Message,{msgId:"queryform.spatialfilter.draw_start_label"}))));var o=this.getMethodFromId(this.props.spatialField.method),n=this.props.showDetailsPanel?s().createElement(Ot,{useMapProjection:this.props.useMapProjection,enableGeodesic:!!ve()(o.geodesic)||o.geodesic,geometry:this.props.spatialField.geometry,type:this.props.spatialField.method,onShowPanel:this.props.actions.onShowSpatialSelectionDetails,onChangeDrawingStatus:this.changeDrawingStatus,zoom:this.props.zoom,projection:this.props.projection}):s().createElement("span",null),i=s().createElement(T.Row,{className:"filter-field-row inline-form filter-field-fixed-row"},s().createElement(T.Col,{xs:6},s().createElement(we.ZP.Message,{msgId:"queryform.spatialfilter.geometric_operation"})),s().createElement(T.Col,{xs:6},s().createElement($e.Z,{fieldOptions:this.props.spatialOperations.map((function(t){return(0,Oe.S$)(e.context.messages,t.name)})),fieldName:"operation",fieldRowId:(new Date).getTime(),fieldValue:(0,Oe.S$)(this.context.messages,t?t.name:""),onUpdateField:this.updateSpatialOperation})));return s().createElement("div",{className:"query-filter-container"},this.props.withContainer?s().createElement(C.Z,{id:"spatialFilterPanel",header:this.renderHeader(),buttons:this.renderButtons(),collapsible:!0,expanded:this.props.spatialPanelExpanded,onSwitch:function(t){return e.props.actions.onExpandSpatialFilterPanel(t)}},this.renderSpatialPanel(i,r,t)):this.renderSpatialPanel(i,r,t),n)}}])&&_t(r.prototype,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,o}(s().Component);kt(Bt,"propTypes",{useMapProjection:a().bool,spatialField:a().object,spatialOperations:a().array,spatialMethodOptions:a().array,spatialPanelExpanded:a().bool,showDetailsButton:a().bool,clearFilterOptions:a().object,showDetailsPanel:a().bool,withContainer:a().bool,actions:a().object,zoom:a().number,projection:a().string}),kt(Bt,"contextTypes",{messages:a().object}),kt(Bt,"defaultProps",{useMapProjection:!0,spatialField:{},spatialPanelExpanded:!0,showDetailsButton:!0,clearFilterOptions:{className:"square-button-sm no-border",buttonStyle:"default"},showDetailsPanel:!1,withContainer:!0,spatialMethodOptions:[],spatialOperations:[],actions:{onExpandSpatialFilterPanel:function(){},onSelectSpatialMethod:function(){},onSelectSpatialOperation:function(){},onChangeSpatialFilterValue:function(){},onChangeDrawingStatus:function(){},onRemoveSpatialSelection:function(){},onShowSpatialSelectionDetails:function(){},onSelectViewportSpatialMethod:function(){},onChangeRegion:function(){},onChangeDwithinValue:function(){},zoneFilter:function(){},zoneSearch:function(){},zoneChange:function(){}}});const Zt=Bt;function Gt(){return Gt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},Gt.apply(this,arguments)}var Vt=(0,r(17252).Z)((function(e){return s().createElement("div",Gt({className:"square-button pull-right no-border",style:{display:"flex"}},e),s().createElement(T.Glyphicon,{glyph:"exclamation-mark",className:"text-danger"}))}));const Ut=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.loadingError,r=e.onToggleQuery,o=void 0===r?function(){}:r,n=e.buttonStyle,i=void 0===n?"default":n;return s().createElement("div",{className:"mapstore-block-width"},s().createElement(ie.Z,{id:"toc-query-close-button",key:"menu-button",className:"square-button no-border",bsStyle:i,onClick:function(){return o()}},s().createElement(T.Glyphicon,{glyph:"arrow-left"})),t&&s().createElement(Vt,{popover:{text:s().createElement(x.Z,{msgId:"queryform.loadingError"})}})||s().createElement("div",{className:"square-button pull-right no-border",style:{display:"flex"}},s().createElement(T.Glyphicon,{glyph:"filter",className:"text-primary"})))};function zt(e){return zt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},zt(e)}function Wt(){return Wt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},Wt.apply(this,arguments)}function Ht(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,Kt(o.key),o)}}function Qt(e,t,r){return t=Xt(t),function(e,t){if(t&&("object"===zt(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,$t()?Reflect.construct(t,r||[],Xt(e).constructor):t.apply(e,r))}function $t(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return($t=function(){return!!e})()}function Xt(e){return Xt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Xt(e)}function Jt(e,t){return Jt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Jt(e,t)}function Yt(e,t,r){return(t=Kt(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Kt(e){var t=function(e,t){if("object"!=zt(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,"string");if("object"!=zt(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==zt(t)?t:t+""}var er=re((function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.crossLayerExpanded,o=void 0===r||r,n=t.spatialOperations,i=t.expandCrossLayerFilterPanel,a=void 0===i?function(){}:i,l=t.layers,u=void 0===l?[]:l,c=t.errorObj,p=t.loadingAttributes,f=t.loadingCapabilities,d=t.searchUrl,y=t.queryCollection,m=void 0===y?{}:y,b=t.attributes,g=void 0===b?[]:b,v=t.operation,h=t.updateLogicCombo,O=void 0===h?function(){}:h,w=t.resetCrossLayerFilter,F=void 0===w?function(){}:w,P=t.setOperation,E=void 0===P?function(){}:P,S=t.setQueryCollectionParameter,j=void 0===S?function(){}:S,q=t.addCrossLayerFilterField,D=void 0===q?function(){}:q,L=t.updateCrossLayerFilterField,B=void 0===L?function(){}:L,Z=t.removeCrossLayerFilterField,G=void 0===Z?function(){}:Z,V=t.toggleMenu,U=void 0===V?function(){}:V,z=m.typeName,W=m.geometryName,H=m.filterFields,Q=m.groupFields,$=void 0===Q?[{id:1,logic:"OR",index:0}]:Q,X=u.filter((function(e){return!k(d,e)}));return s().createElement(C.Z,{loading:f,expanded:o&&!f&&!c,error:c,errorMsgId:"queryPanel",buttons:(e=z?[{glyph:"clear-filter",tooltipId:"queryform.crossLayerFilter.clear",onClick:function(){return F()}}]:[],function(e){if(Array.isArray(e))return A(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return A(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?A(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),onSwitch:a,title:s().createElement(x.Z,{msgId:"queryform.crossLayerFilter.title"})},s().createElement(T.Row,{className:"inline-form filter-field-fixed-row"},s().createElement(T.Col,{xs:6},s().createElement("div",null,s().createElement(x.Z,{msgId:"queryform.crossLayerFilter.targetLayer"})," ",u.length&&X.length?s().createElement(M.Z,{bsStyle:"link",text:s().createElement(x.Z,{msgId:"queryform.crossLayerFilter.errors.layersExcluded"})}):null)),s().createElement(T.Col,{xs:6},s().createElement(N.ZP,{clearable:!1,disabled:f||!!c,isLoading:p,options:u.filter((function(e){return k(d,e)})).map((function(e){return{label:e.title||e.name,value:e.name}})),placeholder:s().createElement(x.Z,{msgId:"queryform.crossLayerFilter.placeholder"}),filter:"contains",value:z,onChange:function(e){j("typeName",e&&e.value)}}))),z&&W?s().createElement(T.Row,{className:"inline-form filter-field-fixed-row"},s().createElement(T.Col,{xs:6},s().createElement("div",null,s().createElement(x.Z,{msgId:"queryform.crossLayerFilter.operation"}))),s().createElement(T.Col,{xs:6},s().createElement(_,{value:v,onChange:function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).id;return E(e)},spatialOperations:R(n)}))):null,z&&W&&v?s().createElement(T.Row,{className:"filter-field-fixed-row"},s().createElement(T.Col,{xs:12},s().createElement(I.Z,{dropUp:!0,autocompleteEnabled:!0,withContainer:!1,attributes:g,groupLevels:-1,filterFields:H,actions:{onUpdateLogicCombo:O,onAddFilterField:D,onUpdateFilterField:B,onRemoveFilterField:G,toggleMenu:U},groupFields:$,filterField:!0}))):null)})),tr=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Qt(this,t,arguments)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Jt(e,t)}(t,e),r=t,(o=[{key:"render",value:function(){if(""!==this.props.featureTypeError)return s().createElement("div",null,s().createElement(Ut,{onToggleQuery:this.props.controlActions.onToggleQuery}),s().createElement("div",{style:{margin:"0 auto","text-align":"center"}},this.props.featureTypeErrorText));var e=s().createElement("div",{className:"m-header"},this.props.header,s().createElement(be,{sendFilters:{attributeFilter:this.props.attributePanelExpanded,spatialFilter:this.props.spatialPanelExpanded,crossLayerFilter:this.props.crossLayerExpanded},params:this.props.params,filterFields:this.props.filterFields,groupFields:this.props.groupFields,spatialField:this.props.spatialField,toolbarEnabled:this.props.toolbarEnabled,searchUrl:this.props.searchUrl,showGeneratedFilter:this.props.showGeneratedFilter,featureTypeName:this.props.featureTypeName,ogcVersion:this.props.ogcVersion,filterType:this.props.filterType,actions:this.props.queryToolbarActions,resultTitle:this.props.resultTitle,pagination:this.props.pagination,sortOptions:this.props.sortOptions,crossLayerFilter:this.props.crossLayerFilterOptions.crossLayerFilter,hits:this.props.hits,allowEmptyFilter:this.props.allowEmptyFilter,emptyFilterWarning:this.props.emptyFilterWarning,appliedFilter:this.props.appliedFilter,storedFilter:this.props.storedFilter,advancedToolbar:this.props.advancedToolbar,loadingError:this.props.loadingError}));return this.props.attributes.length>0?s().createElement(j.Z,{header:e,className:"mapstore-query-builder",id:"query-form-panel"},s().createElement(I.Z,{buttonStyle:this.props.buttonStyle,removeGroupButtonIcon:this.props.removeGroupButtonIcon,autocompleteEnabled:this.props.autocompleteEnabled,maxFeaturesWPS:this.props.maxFeaturesWPS,attributes:this.props.attributes,groupLevels:this.props.groupLevels,filterFields:this.props.filterFields,groupFields:this.props.groupFields,removeButtonIcon:this.props.removeButtonIcon,addButtonIcon:this.props.addButtonIcon,attributePanelExpanded:this.props.attributePanelExpanded,actions:this.props.attributeFilterActions}),this.props.toolsOptions.hideSpatialFilter?null:s().createElement(Zt,{useMapProjection:this.props.useMapProjection,spatialField:this.props.spatialField,clearFilterOptions:this.props.clearFilterOptions,spatialOperations:this.props.spatialOperations,spatialMethodOptions:this.props.spatialMethodOptions,showDetailsButton:this.props.showDetailsButton,spatialPanelExpanded:this.props.spatialPanelExpanded,showDetailsPanel:this.props.showDetailsPanel,actions:this.props.spatialFilterActions,zoom:this.props.zoom,projection:this.props.projection}),this.props.toolsOptions.hideCrossLayer?null:s().createElement(er,Wt({spatialOperations:this.props.spatialOperations,crossLayerExpanded:this.props.crossLayerExpanded,searchUrl:this.props.searchUrl,featureTypeName:this.props.featureTypeName},this.props.crossLayerFilterOptions,this.props.crossLayerFilterActions))):s().createElement("div",{style:{margin:"0 auto",width:"60px"}},s().createElement(S(),{spinnerName:"three-bounce",overrideSpinnerClassName:"spinner"}))}}])&&Ht(r.prototype,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,o}(s().Component);Yt(tr,"propTypes",{params:a().object,featureTypeConfigUrl:a().string,useMapProjection:a().bool,attributes:a().array,featureTypeError:a().string,featureTypeErrorText:a().node,groupLevels:a().number,maxFeaturesWPS:a().number,filterFields:a().array,groupFields:a().array,spatialField:a().object,removeButtonIcon:a().string,addButtonIcon:a().string,attributePanelExpanded:a().bool,showDetailsButton:a().bool,spatialPanelExpanded:a().bool,crossLayerExpanded:a().bool,showDetailsPanel:a().bool,toolbarEnabled:a().bool,searchUrl:a().string,showGeneratedFilter:a().oneOfType([a().bool,a().string]),filterType:a().string,featureTypeName:a().string,ogcVersion:a().string,attributeFilterActions:a().object,spatialFilterActions:a().object,queryToolbarActions:a().object,resultTitle:a().string,pagination:a().object,sortOptions:a().object,spatialOperations:a().array,spatialMethodOptions:a().array,crossLayerFilterOptions:a().object,crossLayerFilterActions:a().object,hits:a().bool,clearFilterOptions:a().object,buttonStyle:a().string,removeGroupButtonIcon:a().string,maxHeight:a().number,allowEmptyFilter:a().bool,autocompleteEnabled:a().bool,emptyFilterWarning:a().bool,header:a().node,zoom:a().number,projection:a().string,toolsOptions:a().object,appliedFilter:a().object,storedFilter:a().object,advancedToolbar:a().bool,loadingError:a().bool,controlActions:a().object}),Yt(tr,"defaultProps",{params:{},featureTypeConfigUrl:null,useMapProjection:!0,groupLevels:1,buttonStyle:"default",removeGroupButtonIcon:"trash",groupFields:[],filterFields:[],attributes:[],spatialMethodOptions:[],spatialOperations:[],featureTypeError:"",spatialField:{},crossLayerFilter:null,removeButtonIcon:"trash",addButtonIcon:"glyphicon glyphicon-plus",attributePanelExpanded:!0,spatialPanelExpanded:!0,showDetailsPanel:!1,toolbarEnabled:!0,searchUrl:"",showGeneratedFilter:!1,featureTypeName:null,pagination:null,sortOptions:null,hits:!1,maxHeight:830,allowEmptyFilter:!1,autocompleteEnabled:!0,emptyFilterWarning:!1,advancedToolbar:!1,loadingError:!1,attributeFilterActions:{onAddGroupField:function(){},onAddFilterField:function(){},onRemoveFilterField:function(){},onUpdateFilterField:function(){},onUpdateExceptionField:function(){},onUpdateLogicCombo:function(){},onRemoveGroupField:function(){},onChangeCascadingValue:function(){},onExpandAttributeFilterPanel:function(){}},spatialFilterActions:{onExpandSpatialFilterPanel:function(){},onSelectSpatialMethod:function(){},onSelectSpatialOperation:function(){},onChangeDrawingStatus:function(){},onRemoveSpatialSelection:function(){},onShowSpatialSelectionDetails:function(){},onSelectViewportSpatialMethod:function(){},onChangeDwithinValue:function(){}},crossLayerFilterOptions:{},crossLayerFilterActions:{},queryToolbarActions:{onQuery:function(){},onReset:function(){},onChangeDrawingStatus:function(){},onSaveFilter:function(){},onRestoreFilter:function(){}},toolsOptions:{},controlActions:{onToggleQuery:function(){}}});const rr=tr;var or=r(99534),nr=r(94745),ir=r(10240),ar=r.n(ir),lr=r(75875),sr=r.n(lr),ur=r(97395),cr=r(84069),pr=r(37275),fr=r(24260),dr=r(69842),yr=r(88113);const mr={isAutoCompleteEnabled:function(e,t){return e.ofType(O.S0).switchMap((function(e){var r=(0,pr.y9)(e.url,{version:"1.0.0",REQUEST:"DescribeProcess",IDENTIFIER:"gs:PagedUnique"},(0,yr.kS)(t.getState()));return null===r?z().Observable.of((0,h.NV)(!1)):z().Observable.fromPromise(sr().post(r,null,{timeout:5e3,headers:{Accept:"application/json","Content-Type":"application/xml"}}).then((function(e){return e.data}))).switchMap((function(e){return ar()(e,"<ows:ExceptionReport")?z().Observable.of((0,h.NV)(!1)):z().Observable.of((0,h.NV)(!0))})).catch((function(){return z().Observable.of((0,h.NV)(!1))}))}))},fetchAutocompleteOptionsEpic:function(e,t){return e.ofType(h.l1,h.nh).debounce((function(e){return z().Observable.timer(e.fieldOptions.delayDebounce||0)})).filter((function(e){return"value"===e.fieldName&&"string"===e.fieldType&&t.getState().queryform.autocompleteEnabled})).switchMap((function(e){var r,o,n,i,a,l,s=t.getState(),u=(0,dr.Vx)(s),c={};if(c=e.type===h.nh?(null===(n=s.queryform.crossLayerFilter)||void 0===n||null===(i=n.collectGeometries)||void 0===i||null===(a=i.queryCollection)||void 0===a||null===(l=a.filterFields)||void 0===l?void 0:l.filter((function(t){return t.rowId===e.rowId}))[0])||{}:s.queryform&&s.queryform.filterFields&&s.queryform.filterFields.filter((function(t){return t.rowId===e.rowId}))[0],"selected"===e.fieldOptions.selected)return z().Observable.from([e.type===h.nh?(0,h.ln)(c,[],0):(0,h.$J)(c,[],0)]);var p=(0,cr.getWpsPayload)({attribute:c.attribute,layerName:e.type===h.nh?null===(r=s.queryform.crossLayerFilter)||void 0===r||null===(o=r.collectGeometries)||void 0===o?void 0:o.queryCollection.typeName:(0,fr.HY)(s),layerFilter:(0,dr.Vc)(s)||(0,dr.hI)(s),maxFeatures:u,startIndex:e.fieldOptions.currentPage?e.fieldOptions.currentPage-1:1*u,value:e.fieldValue}),f=(0,pr.y9)(s.query.url,{outputFormat:"json"},(0,yr.kS)(t.getState()));return null===f?z().Observable.of((0,h.NV)(!1)):z().Observable.fromPromise(sr().post(f,p,{timeout:6e4,headers:{Accept:"application/json","Content-Type":"application/xml"}}).then((function(e){return e.data}))).switchMap((function(t){var r=Ee()(t.values)?t.values:[t.values],o=t.size;return z().Observable.from(e.type===h.nh?[(0,h.ln)(c,r,o),(0,h.js)(e.rowId,!0,"crossLayer")]:[(0,h.$J)(c,r,o),(0,h.js)(e.rowId,!0,"filterField")])})).startWith((0,h.jR)(!0,c,e.type===h.nh?"crossLayer":"filterField")).catch((function(){return z().Observable.from([e.type===h.nh?(0,h.ln)(c,[],0):(0,h.$J)(c,[],0),(0,ur.vU)({title:"warning",message:"warning",action:{label:"warning"},autoDismiss:3,position:"tr"}),(0,h.js)(e.rowId,!0,e.type===h.nh?"crossLayer":"filterField")])})).concat([(0,h.jR)(!1,c,e.type===h.nh?"crossLayer":"filterField")])}))}};var br=r(75982),gr=r(75110);function vr(e){return vr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},vr(e)}function hr(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function Or(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?hr(Object(r),!0).forEach((function(t){wr(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):hr(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function wr(e,t,r){var o;return o=function(e,t){if("object"!=vr(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,"string");if("object"!=vr(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(t),(t="symbol"==vr(o)?o:o+"")in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const Fr={handleLayerFilterPanel:function(e,t){var r=t.getState;return e.ofType(b.Xs).switchMap((function(){var t=(0,gr.Iz)(r()),o=t||{},n=o.url,i=o.name,a=o.layerFilter,l=t&&t.search&&t.search.url;return z().Observable.of((0,O.gT)(l||n,i),(0,h.F)(a),(0,b.HH)(a),(0,d.Xg)("queryPanel","enabled",!0)).merge(z().Observable.of((0,O.jG)()).filter((function(){return!Z()(r(),"query.isLayerFilter")})),e.ofType(h.Wm).switchMap((function(e){var o=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.crossLayerFilter,r=e.spatialField,o=e.filterFields;return!!(o&&Ce()(o)||r&&r.method&&r.operation&&r.geometry||t&&t.collectGeometries&&t.operation)}(e.filterObj)?Or({},Z()(r(),"queryform",{})):void 0;return o&&(o.filterFields=o.attributePanelExpanded&&o.filterFields||[],o.spatialField=o.spatialPanelExpanded&&o.spatialField||null,o.crossLayerFilter=o.crossLayerExpanded&&(0,ne.setupCrossLayerFilterDefaults)(o.crossLayerFilter)||null),z().Observable.of(function(e,t){return(0,g.He)(e,{layerFilter:t})}(t.id,o))}))).let(function(e){return function(t){return t.takeUntil(e.ofType(d.kM).filter((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.control,r=e.property;return"queryPanel"===t&&(!r||"enabled"===r)})).merge(e.ofType(br.nk)))}}(e)).concat(z().Observable.from([(0,O.jG)(),(0,h.mc)(),(0,y.Yf)("clean","","queryform",[],{})]))}))},restoreSavedFilter:function(e,t){var r=t.getState;return e.ofType(b.H1).switchMap((function(){var e={typeName:Z()(r(),"state.query.typeName")},t=Z()(r(),"state.query.url"),o=Z()(r(),"layerFilter.persisted");return z().Observable.of((0,y.Yf)("clean","","queryform",[]),(0,h.F)(o),(0,h.yC)(t,o,e),(0,O.Xc)())}))},onApplyFilter:function(e,t){var r=t.getState;return e.ofType(b.MY).map((function(){var e=Or({},Z()(r(),"queryform",{}));return(0,b.Xr)(e)}))}};var Pr=r(13292),Er=r.n(Pr);const Sr={updateSpatialFilterValue:function(e){return e.ofType(h.Wi).switchMap((function(e){var t=e.feature,r=e.srsName,o=e.style,n=e.options;return U.Observable.of((0,y.Yf)("drawOrEdit",t.geometry.type,"queryform",[t],{editEnabled:!1,stopAfterDrawing:!0,featureProjection:r},o)).concat(t&&n&&n.autoZoom?[(0,v.Px)(Er()(t),r)]:[])}))}};var jr=r(827),xr=r(72500),Cr=r(31255),Tr=r(85148);function Nr(e){return Nr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Nr(e)}function qr(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function Dr(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?qr(Object(r),!0).forEach((function(t){_r(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):qr(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function _r(e,t,r){var o;return o=function(e,t){if("object"!=Nr(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,"string");if("object"!=Nr(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(t),(t="symbol"==Nr(o)?o:o+"")in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ir(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function Lr(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ir(Object(r),!0).forEach((function(t){Mr(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ir(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Mr(e,t,r){var o;return o=function(e,t){if("object"!=Ar(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,"string");if("object"!=Ar(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(t),(t="symbol"==Ar(o)?o:o+"")in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ar(e){return Ar="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ar(e)}var kr=function(e){return{geometry:e.featureTypes[0].properties.filter((function(e){return 0===e.type.indexOf("gml:")})).map((function(e){return{label:e.name,attribute:e.name,type:"geometry",valueId:"id",valueLabel:"name",values:[]}})),original:e,attributes:$(e)}};function Rr(e){return Rr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Rr(e)}function Br(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function Zr(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Br(Object(r),!0).forEach((function(t){Gr(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Br(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Gr(e,t,r){var o;return o=function(e,t){if("object"!=Rr(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,"string");if("object"!=Rr(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(t),(t="symbol"==Rr(o)?o:o+"")in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Vr={};var Ur=r(97301),zr=r(46905),Wr=r(67306),Hr=r(55105),Qr=r(24262),$r=r(81756);function Xr(e){return Xr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Xr(e)}function Jr(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,io(o.key),o)}}function Yr(e,t,r){return t=eo(t),function(e,t){if(t&&("object"===Xr(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,Kr()?Reflect.construct(t,r||[],eo(e).constructor):t.apply(e,r))}function Kr(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Kr=function(){return!!e})()}function eo(e){return eo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},eo(e)}function to(e,t){return to=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},to(e,t)}function ro(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function oo(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ro(Object(r),!0).forEach((function(t){no(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ro(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function no(e,t,r){return(t=io(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function io(e){var t=function(e,t){if("object"!=Xr(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,"string");if("object"!=Xr(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Xr(t)?t:t+""}var ao=h.mc.bind(null,"query"),lo=(0,u.connect)((function(e){return{useMapProjection:e.queryform.useMapProjection,groupLevels:e.queryform.groupLevels,groupFields:e.queryform.groupFields,filterFields:e.queryform.filterFields,attributes:e.query&&e.query.typeName&&e.query.featureTypes&&e.query.featureTypes[e.query.typeName]&&e.query.featureTypes[e.query.typeName].attributes,featureTypeError:e.query&&e.query.typeName&&e.query.featureTypes&&e.query.featureTypes[e.query.typeName]&&e.query.featureTypes[e.query.typeName].error,spatialField:e.queryform.spatialField,showDetailsPanel:e.queryform.showDetailsPanel,toolbarEnabled:e.queryform.toolbarEnabled,attributePanelExpanded:e.queryform.attributePanelExpanded,autocompleteEnabled:e.queryform.autocompleteEnabled,crossLayerExpanded:e.queryform.crossLayerExpanded,crossLayerFilterOptions:oo({layers:(0,dr.GK)(e),crossLayerFilter:(0,dr.qh)(e)},e.queryform.crossLayerFilterOptions||{}),maxFeaturesWPS:e.queryform.maxFeaturesWPS,spatialPanelExpanded:e.queryform.spatialPanelExpanded,featureTypeConfigUrl:e.query&&e.query.url,searchUrl:e.query&&e.query.url,featureTypeName:e.query&&e.query.typeName,ogcVersion:"1.1.0",params:{typeName:e.query&&e.query.typeName},resultTitle:"Query Result",showGeneratedFilter:!1,allowEmptyFilter:!0,emptyFilterWarning:!0,maxHeight:e.map&&e.map.present&&e.map.present.size&&e.map.present.size.height,zoom:((0,jr.Od)(e)||{}).zoom,projection:((0,jr.Od)(e)||{}).projection}}),(function(e){return{attributeFilterActions:(0,p.DE)({onAddGroupField:h.kQ,onAddFilterField:h.jW,onRemoveFilterField:h.JG,onUpdateFilterField:h.q$,onUpdateExceptionField:h.OZ,onUpdateLogicCombo:h.Nc,onRemoveGroupField:h.I5,onChangeCascadingValue:h.QL,toggleMenu:h.js,onExpandAttributeFilterPanel:h.I},e),spatialFilterActions:(0,p.DE)({onChangeSpatialFilterValue:h.uo,onExpandSpatialFilterPanel:h.ku,onSelectSpatialMethod:h.HT,onSelectViewportSpatialMethod:h.lg,onSelectSpatialOperation:h.VF,onChangeDrawingStatus:y.Yf,onRemoveSpatialSelection:h.Ry,onShowSpatialSelectionDetails:h.ZH,onChangeDwithinValue:h.AQ,zoneFilter:h.eJ,zoneSearch:h.uM,zoneChange:h.uP},e),queryToolbarActions:(0,p.DE)({onQuery:h.yC,onReset:ao,onSaveFilter:b.no,onRestoreFilter:b.Nd,storeAppliedFilter:b.Rb,onChangeDrawingStatus:y.Yf},e),crossLayerFilterActions:(0,p.DE)({expandCrossLayerFilterPanel:h.EU,setCrossLayerFilterParameter:h.IV,addCrossLayerFilterField:h.N5,updateCrossLayerFilterField:h.bn,removeCrossLayerFilterField:h.Bm,resetCrossLayerFilter:h.F2,toggleMenu:function(e,t){return(0,h.js)(e,t,"crossLayer")}},e),controlActions:(0,p.DE)({onToggleQuery:d.Xi.bind(null,"queryPanel",null)},e)}}))(rr),so=(0,f.P1)([function(e){return e.controls&&e.controls.toolbar&&"toc"===e.controls.toolbar.active},gr.Bt,function(e){return e.layers&&e.layers.settings||{expanded:!1,options:{opacity:1}}},function(e){return e.controls&&e.controls.queryPanel&&e.controls.queryPanel.enabled||!1},function(e){return(0,Hr.ic)(e,{height:!0})},Wr.Wy,dr.Vc,dr.hI,function(e){return e&&e.query&&e.query.isLayerFilter},gr.P_],(function(e,t,r,o,n,i,a,l,s,u){return{enabled:e,groups:t,settings:r,querypanelEnabled:o,layout:i?{}:n,appliedFilter:a,storedFilter:l,advancedToolbar:s,loadingError:u}})),uo=function(e){function t(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),no(r=Yr(this,t,[e]),"getNoBackgroundLayers",(function(e){return"background"!==e.name})),no(r,"renderSidebar",(function(){return s().createElement(c.Z,{open:r.props.querypanelEnabled,sidebar:r.renderQueryPanel(),sidebarClassName:"query-form-panel-container",touch:!1,styles:{sidebar:oo(oo({},r.props.layout),{},{zIndex:1024,width:600}),overlay:{zIndex:1023,width:0},root:{right:r.props.querypanelEnabled?0:"auto",width:"0",overflow:"visible"},content:{overflowY:"auto"}}},s().createElement("div",null))})),no(r,"onToggle",(function(){r.props.advancedToolbar&&!n()(r.props.appliedFilter,r.props.storedFilter)?r.setState((function(){return{showModal:!0}})):r.props.onToggleQuery()})),no(r,"restoreAndClose",(function(){r.setState((function(){return{showModal:!1}})),r.props.onRestoreFilter(),r.props.onToggleQuery()})),no(r,"storeAndClose",(function(){r.setState((function(){return{showModal:!1}})),r.props.onSaveFilter(),r.props.onToggleQuery()})),no(r,"renderQueryPanel",(function(){return s().createElement("div",{className:"mapstore-query-builder"},s().createElement(lo,{header:s().createElement(Ut,{loadingError:r.props.loadingError,onToggleQuery:r.onToggle}),spatialOperations:r.props.spatialOperations,spatialMethodOptions:r.props.spatialMethodOptions,toolsOptions:r.props.toolsOptions,featureTypeErrorText:s().createElement($r.Z,{msgId:"layerProperties.featureTypeError"}),appliedFilter:r.props.appliedFilter,storedFilter:r.props.storedFilter,advancedToolbar:r.props.advancedToolbar,loadingError:r.props.loadingError}),s().createElement(or.Z,null,s().createElement(nr.Z,{fade:!0,show:r.state.showModal,title:s().createElement($r.Z,{msgId:"queryform.changedFilter"}),size:"xs",onClose:function(){return r.setState((function(){return{showModal:!1}}))},buttons:[{bsStyle:"primary",text:s().createElement($r.Z,{msgId:"yes"}),onClick:r.storeAndClose},{bsStyle:"primary",text:s().createElement($r.Z,{msgId:"no"}),onClick:r.restoreAndClose}]},s().createElement("div",{className:"ms-alert"},s().createElement("div",{className:"ms-alert-center"},s().createElement($r.Z,{msgId:r.props.loadingError?"queryform.changedFilterWithErrorAlert":"queryform.changedFilterAlert"}))))))})),r.state={showModal:!1},r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&to(e,t)}(t,e),r=t,(o=[{key:"UNSAFE_componentWillReceiveProps",value:function(e){!0===e.querypanelEnabled&&!1===this.props.querypanelEnabled&&this.props.onInit()}},{key:"render",value:function(){return this.renderSidebar()}}])&&Jr(r.prototype,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,o}(s().Component);no(uo,"propTypes",{id:a().number,buttonContent:a().node,groups:a().array,settings:a().object,querypanelEnabled:a().bool,groupStyle:a().object,groupPropertiesChangeHandler:a().func,layerPropertiesChangeHandler:a().func,onToggleGroup:a().func,onToggleLayer:a().func,onToggleQuery:a().func,onZoomToExtent:a().func,retrieveLayerData:a().func,onSort:a().func,onInit:a().func,onSettings:a().func,hideSettings:a().func,updateSettings:a().func,updateNode:a().func,removeNode:a().func,activateRemoveLayer:a().bool,activateLegendTool:a().bool,activateZoomTool:a().bool,activateSettingsTool:a().bool,visibilityCheckType:a().string,settingsOptions:a().object,layout:a().object,toolsOptions:a().object,appliedFilter:a().object,storedFilter:a().object,advancedToolbar:a().bool,onSaveFilter:a().func,onRestoreFilter:a().func}),no(uo,"defaultProps",{groupPropertiesChangeHandler:function(){},layerPropertiesChangeHandler:function(){},retrieveLayerData:function(){},onToggleGroup:function(){},onToggleLayer:function(){},onToggleQuery:function(){},onZoomToExtent:function(){},onSettings:function(){},onInit:function(){},updateNode:function(){},removeNode:function(){},activateLegendTool:!0,activateZoomTool:!0,activateSettingsTool:!0,activateRemoveLayer:!0,visibilityCheckType:"checkbox",settingsOptions:{},querypanelEnabled:!1,layout:{},toolsOptions:{},onSaveFilter:function(){},onRestoreFilter:function(){}});const co={QueryPanelPlugin:(0,u.connect)(so,{groupPropertiesChangeHandler:g.WO,layerPropertiesChangeHandler:g.He,retrieveLayerData:m.k,onToggleGroup:(0,Qr.$0)("groups",g.bh),onToggleLayer:(0,Qr.$0)("layers",g.bh),onToggleQuery:d.Xi.bind(null,"queryPanel",null),onSort:(0,Qr.dD)(Qr.lD,g.MK),onSettings:g.RP,onInit:O.Xc,onZoomToExtent:v.Px,hideSettings:g.sF,updateSettings:g.VP,updateNode:g.tV,removeNode:g.ZF,onSaveFilter:b.no,onRestoreFilter:b.Nd})(uo),reducers:{queryform:zr.Z,query:Ur.Z,layerFilter:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Vr,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case b.y6:return Zr(Zr({},Vr),{},{persisted:t.filter,applied:t.filter});case b.H1:return Zr(Zr({},e),{},{applied:e.persisted});case b.g$:return Zr(Zr({},e),{},{applied:t.filter});case b.Xk:return Zr(Zr({},e),{},{persisted:e.applied});case h.Eg:return Zr(Zr({},e),{},{applied:void 0});default:return e}}},epics:oo(oo(oo({featureTypeSelectedEpic:function(e,t){return e.ofType(O.S0).filter((function(e){return e.url&&e.typeName})).switchMap((function(e){var r=t.getState();if((0,fr.hk)(r,e.typeName)){var o=kr((0,fr.qj)(r,e.typeName)),n=o.geometry[0]&&o.geometry[0].attribute?o.geometry[0].attribute:"the_geom";return z().Observable.of((0,O.rG)(e.typeName,o),(0,h.DD)(n),z().Scheduler.async)}var i=(0,Cr.Li)(r);return i&&"vector"===i.type?z().Observable.defer((function(){return sr().get(e.url)})).map((function(t){var r={featureTypes:[t.data.featureTypes[0]]},o={geometry:r.featureTypes[0].properties.filter((function(e){return 0===e.name.indexOf("geometry")})).map((function(e){return e})),original:r,attributes:$(r)},n=o.geometry[0]&&o.geometry[0].attribute?o.geometry[0].attribute:"the_geom",i=new Promise((function(e){e((0,h.DD)(n))})).then((function(){return new Promise((function(t){t((0,O.rG)(e.typeName,o))}))}));return z().Observable.defer((function(){return i}))})).mergeAll():z().Observable.defer((function(){return sr().get(pr.ZP.filterUrlParams(e.url,(0,yr.kS)(t.getState()))+"?service=WFS&version=1.1.0&request=DescribeFeatureType&typeName="+e.typeName+"&outputFormat=application/json")})).map((function(t){if("object"===Ar(t.data)&&t.data.featureTypes&&t.data.featureTypes[0]){var r=kr(t.data),o=r.geometry[0]&&r.geometry[0].attribute?r.geometry[0].attribute:"the_geom";return z().Observable.from([(0,h.DD)(o),(0,O.rG)(e.typeName,r)])}try{JSON.parse(t.data)}catch(t){return z().Observable.from([(0,O.t3)(e.typeName,"Error from WFS: "+t.message),ur.vU({title:"warning",message:"layerProperties.featureTypeErrorInvalidJSON",autoDismiss:3,position:"tc"})])}return z().Observable.from([(0,O.t3)(e.typeName,"Error: feature types are empty")])})).mergeAll().catch((function(t){return z().Observable.of((0,O.t3)(e.typeName,t.message||t.statusText))}))}))},wfsQueryEpic:function(e,t){return e.ofType(O.Qq).switchMap((function(r){var o,n,i,a,l=(i=(a=t.getState()).query&&a.query.featureTypes&&a.query.featureTypes[a.query.typeName]&&a.query.featureTypes[a.query.typeName].attributes&&a.query.featureTypes[a.query.typeName].attributes[0]&&a.query.featureTypes[a.query.typeName].attributes[0].attribute||null)?{sortBy:i,sortOrder:"A"}:{},s=(null==r||null===(o=r.filterObj)||void 0===o?void 0:o.sortOptions)||l,u=fr.b0.totalFeatures(t.getState()),c=pr.ZP.filterUrlParams(r.searchUrl,(0,yr.kS)(t.getState())),p=(0,Cr.Li)(t.getState()),f=(0,Cr.lg)(t.getState()),d=null!=p?p:{},y=d.layerFilter,m=d.params,b=void 0===m?{}:m,v=null==b?void 0:b[V()(Object.keys(b||{}),(function(){return"cql_filter"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"").toLowerCase()}))],h="vector"===(null==p?void 0:p.type)?r.filterObj:(0,ne.mergeFiltersToOGC)({ogcVersion:"1.1.0"},v,f?y:null,r.filterObj),w=function(e,t,r){var o=(0,Cr.u$)(r),n=(0,Tr.jo)({id:o},"time")(r),i=(0,gr.CA)(r,o)||{},a=Z()(i,'params["time"]');if((0,Cr.DK)(r)&&n&&a){var l=(0,xr.parse)(e)||{};return{url:(0,xr.format)(Dr(Dr({},l),{},{query:Dr(Dr({},l.query),{},{time:a})})),options:t}}return{url:e,options:t}}(c,r.queryOptions||{},t.getState()),F=w.url,P=w.options,E=Lr(Lr(Lr({},r.filterObj.pagination),{},{totalFeatures:u,sortOptions:s},P),{},{layer:p});return z().Observable.merge((0,W.Mc)(Lr(Lr({},p),{},{name:r.filterObj.featureTypeName||(null==p?void 0:p.name),search:Lr(Lr({},null!==(n=null==p?void 0:p.search)&&void 0!==n?n:{}),{},{url:F})}),h,E).map((function(e){return(0,O.w_)(e,r.searchUrl,r.filterObj,r.queryOptions,r.reason)})).catch((function(e){return z().Observable.of((0,O.Lm)(e))})).startWith((0,O.Fs)(!0)).concat(z().Observable.of((0,O.Fs)(!1)),z().Observable.of((0,g.kI)(null==p?void 0:p.id)))).takeUntil(e.ofType(O.VN))}))},viewportSelectedEpic:function(e,t){return e.ofType(h.On,v.pP).switchMap((function(e){var r=e.type===v.pP?e:(0,jr.Od)(t.getState());if((e.type===h.On||e.type===v.pP&&"Viewport"===(0,dr.BU)(t.getState()))&&r.bbox&&r.bbox.bounds&&r.bbox.crs){var o=Object.keys(r.bbox.bounds).reduce((function(e,t){return ut()({},e,Mr({},t,parseFloat(r.bbox.bounds[t])))}),{});return z().Observable.of((0,h.ds)(ct.default.getViewportGeometry(o,r.bbox.crs)))}return z().Observable.empty()}))},redrawSpatialFilterEpic:function(e,t){return e.ofType(O.R1).switchMap((function(){var e=t.getState(),r=(0,dr.vE)(e),o={type:"Feature",geometry:{type:(0,dr.a8)(e),coordinates:(0,dr.G$)(e)}},n=(0,dr.Nl)(e)?(0,y.Yf)("drawOrEdit",r.method||"","queryform",[o],{featureProjection:(0,dr.IM)(e),drawEnabled:!1,editEnabled:!1}):(0,y.Yf)("clean",r.method||"","queryform",[],{drawEnabled:!1,editEnabled:!1});return z().Observable.of(n)}))}},mr),Sr),Fr)}},81756:(e,t,r)=>{"use strict";r.d(t,{Z:()=>i});var o=r(71703),n=r(5346);const i=(0,o.connect)((function(e){return{locale:e.locale&&e.locale.currentLocale,messages:e.locale&&e.locale.messages||[]}}))(n.Z)},67306:(e,t,r)=>{"use strict";r.d(t,{Wy:()=>i,i$:()=>a,P0:()=>l,NB:()=>s,MZ:()=>u,J:()=>c,DZ:()=>p,hS:()=>f,CN:()=>d,fd:()=>y,Yl:()=>m,Ip:()=>b});var o=r(22222),n=r(24684),i=function(e){return e&&e.dashboard&&e.dashboard.editor&&e.dashboard.editor.available},a=function(e){return e&&e.dashboard&&e.dashboard.editing},l=function(e){return e&&e.dashboard&&e.dashboard.showConnections},s=function(e){return e&&e.dashboard&&e.dashboard.resource},u=function(e){return e&&e.dashboard&&e.dashboard.loading},c=function(e){return e&&e.browser&&e.browser.mobile},p=(0,o.P1)(n.F,s,c,(function(e,t,r){return r?!r:t&&t.canEdit||isNaN(e.substr(-4))})),f=function(e){var t;return null==e||null===(t=e.dashboard)||void 0===t?void 0:t.originalData},d=function(e){return e&&e.dashboard&&e.dashboard.services},y=function(e){return e&&e.dashboard&&e.dashboard.selectedService},m=function(e){return e&&e.dashboard&&e.dashboard.mode||"view"},b=function(e){var t;return(null===(t=e.dashboard)||void 0===t?void 0:t.isNew)||!1}},55105:(e,t,r)=>{"use strict";r.d(t,{Ss:()=>y,Nr:()=>m,ic:()=>g,Jz:()=>v,VM:()=>h,CF:()=>O,Ju:()=>w});var o=r(91175),n=r.n(o),i=r(88306),a=r.n(i),l=r(827),s=r(52259),u=r(37275);function c(e){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c(e)}function p(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function f(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?p(Object(r),!0).forEach((function(t){d(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):p(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function d(e,t,r){var o;return o=function(e,t){if("object"!=c(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,"string");if("object"!=c(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(t),(t="symbol"==c(o)?o:o+"")in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var y=function(e){return e.maplayout&&e.maplayout.layout||{}},m=function(e){return e.maplayout&&e.maplayout.boundingMapRect||{}},b=function(e){return e.maplayout&&e.maplayout.boundingSidebarRect||{}},g=a()((function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=y(e),n=b(e);return o&&Object.keys(o).filter((function(e){return t[e]})).reduce((function(e,t){var i;return f(f({},e),{},d({},t,r&&null!==(i=n[t])&&void 0!==i?i:o[t]))}),{})||{}}),(function(e,t,r){return JSON.stringify(y(e))+JSON.stringify(b(e))+JSON.stringify(t)+(r?"_isDock":"")})),v=function(e){var t;return!(null===(t=y(e))||void 0===t||!t.rightPanel)},h=function(e){var t,r=u.ZP.getConfigProp("mapLayout")||s.DEFAULT_MAP_LAYOUT;return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=y(e);return!!n()(t.filter((function(e){return r[e.key]})).map((function(e){return"not"===e.type?r[e.key]!==e.value&&r[e.key]:r[e.key]===e.value})))}(e,[{key:"bottom",value:null!==(t=null==r?void 0:r.bottom.sm)&&void 0!==t?t:0,type:"not"}])},O=function(e){var t=(0,l.Od)(e),r=m(e);return r&&t&&t.size&&{left:(0,s.parseLayoutValue)(r.left,t.size.width),bottom:(0,s.parseLayoutValue)(r.bottom,t.size.height),right:(0,s.parseLayoutValue)(r.right,t.size.width),top:(0,s.parseLayoutValue)(r.top,t.size.height)}},w=function(e){var t,r;return null!==(t=null==e||null===(r=e.maplayout)||void 0===r?void 0:r.dockPanels)&&void 0!==t?t:{left:[],right:[]}}},69842:(e,t,r)=>{"use strict";r.d(t,{qh:()=>d,GK:()=>y,Nl:()=>m,vE:()=>b,gC:()=>g,hI:()=>v,Vc:()=>h,BU:()=>O,Vx:()=>w,a8:()=>F,IM:()=>P,G$:()=>E});var o=r(27361),n=r.n(o),i=r(22222),a=r(75110),l=r(8316),s=r(86638);function u(e){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u(e)}var c=["title"];function p(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function f(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?p(Object(r),!0).forEach((function(t){var o,n,i,a;o=e,n=t,i=r[t],a=function(e,t){if("object"!=u(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,"string");if("object"!=u(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(n),(n="symbol"==u(a)?a:a+"")in o?Object.defineProperty(o,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):o[n]=i})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):p(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var d=function(e){return n()(e,"queryform.crossLayerFilter")},y=function(e){return((0,a.l2)(e)||[]).filter((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.type,r=e.group;return"wms"===t&&"background"!==r})).map((function(t){var r=t.title;return f(f({},function(e,t){if(null==e)return{};var r,o,n=function(e,t){if(null==e)return{};var r,o,n={},i=Object.keys(e);for(o=0;o<i.length;o++)r=i[o],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)r=i[o],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}(t,c)),{},{title:(0,s.MZ)((0,l.Pz)(e),r)})}))},m=function(e){return n()(e,"queryform.spatialField.geometry")},b=function(e){return n()(e,"queryform.spatialField")},g=(0,i.P1)((function(e){return n()(e,"queryform.attributePanelExpanded")}),(function(e){return n()(e,"queryform.spatialPanelExpanded")}),(function(e){return n()(e,"queryform.crossLayerExpanded")}),(function(e,t,r){return{attributePanelExpanded:e,spatialPanelExpanded:t,crossLayerExpanded:r}})),v=function(e){return n()(e,"layerFilter.persisted")},h=function(e){return n()(e,"layerFilter.applied")},O=function(e){return n()(e,"queryform.spatialField.method")},w=function(e){return n()(e,"queryform.maxFeaturesWPS")},F=function(e){return m(e)&&m(e).type||"Polygon"},P=function(e){return m(e)&&m(e).projection||"EPSG =4326"},E=function(e){return m(e)&&m(e).coordinates||[]}},24684:(e,t,r)=>{"use strict";r.d(t,{F:()=>i,y:()=>a});var o=r(27361),n=r.n(o),i=function(e){return n()(e,"router.location.pathname")||"/"},a=function(e){return n()(e,"router.location.search")||""}},10284:(e,t,r)=>{"use strict";r.d(t,{sw:()=>m,oB:()=>b});var o=r(49977),n=r.n(o),i=r(27361),a=r.n(i),l=r(5055),s=r(7526);function u(e){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u(e)}function c(e){var t="function"==typeof Map?new Map:void 0;return c=function(e){if(null===e||!function(e){try{return-1!==Function.toString.call(e).indexOf("[native code]")}catch(t){return"function"==typeof e}}(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return function(e,t,r){if(p())return Reflect.construct.apply(null,arguments);var o=[null];o.push.apply(o,t);var n=new(e.bind.apply(e,o));return r&&f(n,r.prototype),n}(e,arguments,d(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),f(r,e)},c(e)}function p(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(p=function(){return!!e})()}function f(e,t){return f=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},f(e,t)}function d(e){return d=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},d(e)}r(49843);var y=function(e){function t(e,r){var o,n,i,a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=this,i=t,a=[e],i=d(i),o=function(e,t){if(t&&("object"===u(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(n,p()?Reflect.construct(i,a||[],d(n).constructor):i.apply(n,a))).name="OGCError",o.code=r,o}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&f(e,t)}(t,e),r=t,Object.defineProperty(r,"prototype",{writable:!1}),r;var r}(c(Error)),m=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{tagNameProcessors:[s.stripPrefix],explicitArray:!1,mergeAttrs:!0};return n().Observable.bindNodeCallback((function(e,r){return(0,l.parseString)(e,t,r)}))(e)},b=function(e){return e.switchMap((function(e){return"string"==typeof e.data&&e.data.indexOf("ExceptionReport")>0?n().Observable.bindNodeCallback((function(e,t){return(0,l.parseString)(e,{tagNameProcessors:[s.stripPrefix],explicitArray:!1,mergeAttrs:!0},t)}))(e.data).map((function(e){var t=a()(e,"ExceptionReport.Exception.ExceptionText");throw new y(t||"Undefined OGC Service Error",a()(e,"ExceptionReport.Exception.exceptionCode"))})):n().Observable.of(e)}))}},39156:(e,t,r)=>{function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}function n(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?n(Object(r),!0).forEach((function(t){var n,i,a,l;n=e,i=t,a=r[t],l=function(e,t){if("object"!=o(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!=o(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(i),(i="symbol"==o(l)?l:l+"")in n?Object.defineProperty(n,i,{value:a,enumerable:!0,configurable:!0,writable:!0}):n[i]=a})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var a=r(2245),l=r(84596),s=r(78889).wfsToGmlVersion;e.exports=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.wfsVersion,r=void 0===t?"1.1.0":t,o=e.gmlVersion,n=e.filterNS,u=e.wfsNS,c=void 0===u?"wfs":u,p=o;!p&&r?p=s(r):p||(p="3.1.1");var f=function(e){return l(e).map((function(e){return"<".concat("2.0"===r?"fes":"ogc",":PropertyName>").concat(e,"</").concat("2.0"===r?"fes":"ogc",":PropertyName>")})).join("")};return i(i({propertyName:f},a({gmlVersion:p,wfsVersion:r,filterNS:n||"2.0"===r?"fes":"ogc"})),{},{getFeature:function(e,t){return"<".concat(c,":GetFeature ").concat(function(){var e,t,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=o.viewParams,i=o.resultType,a=o.outputFormat,l=o.startIndex,s=o.maxFeatures;return(0===r.indexOf("1.")?'service="WFS" version="'+(t=r)+'" '+("1.0.0"===t?'outputFormat="GML2" ':"")+'xmlns:gml="http://www.opengis.net/gml" xmlns:wfs="http://www.opengis.net/wfs" xmlns:ogc="http://www.opengis.net/ogc" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.opengis.net/wfs '+"http://schemas.opengis.net/wfs/".concat(t,"1.0.0"===t?'/WFS-basic.xsd"':'/wfs.xsd"'):function(e){return'service="WFS" version="'+e+'" xmlns:wfs="http://www.opengis.net/wfs/2.0" xmlns:fes="http://www.opengis.net/fes/2.0" xmlns:gml="http://www.opengis.net/gml/3.2" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.opengis.net/wfs/2.0 http://schemas.opengis.net/wfs/2.0/wfs.xsd http://www.opengis.net/gml/3.2 http://schemas.opengis.net/gml/3.2.1/gml.xsd"'}(r))+(i?' resultType="'.concat(i,'"'):"")+(a?' outputFormat="'.concat(a,'"'):"")+(l||0===l?' startIndex="'.concat(l,'"'):"")+(s||0===s?" ".concat((e=s,0===r.indexOf("2.")?'count="'.concat(e,'"'):'maxFeatures="'.concat(e,'"'))):"")+(n?' viewParams="'.concat(n,'"'):"")}(t),">").concat(Array.isArray(e)?e.join(""):e,"</").concat(c,":GetFeature>")},sortBy:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"ASC";return"<".concat(c,":SortBy><").concat(c,":SortProperty>").concat(f(e),"<").concat(c,":SortOrder>").concat(t,"</").concat(c,":SortOrder></").concat(c,":SortProperty></").concat(c,":SortBy>")},query:function(e,t){var o=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).srsName,n=void 0===o?"EPSG:4326":o;return"<".concat(c,":Query ").concat("2.0"===r?"typeNames":"typeName",'="').concat(e,'" ').concat("native"!==n?'srsName="'.concat(n,'"'):"",">")+"".concat(Array.isArray(t)?t.join(""):t)+"</".concat(c,":Query>")}})}},49469:(e,t,r)=>{"use strict";r.d(t,{Z:()=>i});var o=r(23645),n=r.n(o)()((function(e){return e[1]}));n.push([e.id,"",""]);const i=n}}]);